## 목차

- [7. 구현 노트](#implementationnotes)
  - [7.1 - 입찰하지 않음을 알리는 시그널](#nobidsignaling)
  - [7.2 - 노출 만료](#impressionexpiration)
  - [7.3 - PMP 및 직접 거래](#pmpanddirectdeals)
  - [7.4 - 스킵 가능성](#skippability)
  - [7.5 - 규제 리소스](#regsresources)
  - [7.6 - 비디오 및 오디오 팟 입찰](#podbidding)
  - [7.7 - 네트워크 대 채널 예시 사례](#networkandchannel)
  - [7.8 - 청구 가능 이벤트와 추적 광고 계산](#counting)
  - [7.9 - 디지털 아웃오브홈](#dooh)
  - [7.10 - 업데이트된 비디오 시그널](#videosignals)
  - [7.11 - 플로어 사용 가이드](#floors)
  - [7.12 - ID 매칭 방식 가이드](#idmm)
  - [7.13 - 장르 및 gtax 속성 사용](#genre)
  - [7.14 - 확장 콘텐츠 식별자 사용](#cids)


# 7. 구현 노트 <a name="implementationnotes"></a>

이번 섹션에서는 특정 객체와 필드를 어떻게 해석하고 구현해야 하는지에 대한 간단한 설명을 제공한다.


## 7.1 - No-Bid 시그널링 <a name="nobidsignaling"></a>

이 섹션에서는 선택적 no-bid 시그널링 사용에 대한 최적의 방법을 다룬다. OpenRTB 3.0의 [List: No-Bid Reason Codes](https://github.com/InteractiveAdvertisingBureau/openrtb/blob/master/OpenRTB%20v3.0%20FINAL.md#list--no-bid-reason-codes-)에서 no-bid 이유 코드의 열거형 목록을 확인할 수 있다.

많은 교환 플랫폼은 no-bid에 대해 여러 응답 타입을 지원한다:

- 입찰자로부터의 HTTP 204 "No Content" 응답 (*대역폭 측면에서 가장 경제적*).
- 빈 JSON 객체:<br>
	```javascript
	{}
	```
- 잘 구성된 no-bid 응답:<br>
	```javascript
	{"id": "1234567890", "seatbid": []}
	```
- 이유 코드가 포함된 잘 구성된 no-bid 응답:<br>
	```javascript
	{"id": "1234567890", "seatbid": [], "nbr": 2}
	```

RTB에서 중요한 문제 중 하나는 웹 브라우저를 모방한 소프트웨어 봇에 의해 노출이 트리거되는 경우다. 이러한 봇은 암묵적 또는 명시적으로 이러한 가짜 트랜잭션을 유발할 수 있다. 다음은 교환 플랫폼과 입찰자가 이러한 이벤트를 인식하고 거부할 수 있도록 돕는 대칭적 최적의 방법을 나타낸다.

*교환 플랫폼의 책임*

다음의 최적의 방법을 통해 비인간 트래픽(NHT) 광고 요청을 분류하고 거부하기 위해 최선을 다한다:

- (권장) 알려진 스파이더의 노출을 user-agent 분류를 통해 필터링한다.
- (권장) 의심스러운 NHT의 노출을 "탐지기"를 통해 필터링한다.

*입찰자의 책임*

- (권장) 알려진 스파이더의 노출을 user-agent 분류를 통해 no-bid 처리한다.
- (권장) 의심스러운 NHT의 노출을 "탐지기"를 통해 no-bid 처리한다.
- 두 경우 모두 no-bid 이유 코드를 지정한다.

*어디에서:*

- 교환 플랫폼의 경우, 노출을 필터링한다는 것은 "광고 호출"에 대해 빈 HTTP 204 응답 또는 무료 광고(PSA)로 응답하고 입찰자에게 제공하지 않아야 한다는 의미다.
- 입찰자의 경우, 노출을 필터링한다는 것은 no-bid로 응답해야 한다는 의미다.
- 교환 플랫폼과 입찰자 모두의 경우, 노출 트랜잭션 기록은 모든 로깅 시스템에 명확히 표시하고, 계획, 예측, 보고 시스템과 관련된 이벤트 카운트에 기여하지 않도록 제거해야 한다.


## 7.2 - 광고 노출 만료 <a name="impressionexpiration"></a>

RTB(실시간 입찰)를 통한 일반적인 광고 노출 흐름을 다시 살펴보면, 클라이언트(예: 웹 브라우저, 모바일 앱 또는 내장 SDK)가 광고를 요청하고, 이 요청은 여러 서버 중개자를 거쳐 최종적으로 RTB 거래소에 도달한다. 거래소는 입찰자들 간에 경매를 진행하며, 입찰자는 제안 가격, 입찰 성공 시 사용할 마크업(마크업은 입찰 성공 알림 자체로 전달될 수도 있음), 그리고 입찰에 관한 기타 메타데이터를 제출한다. 거래소는 입찰 승자를 선정하고, 승자에게 입찰 성공 알림을 발송하며, 마크업을 클라이언트로 전달한다.

그러나 경매에서 승리한다고 해서 광고가 클라이언트에게 성공적으로 전달되거나 시청 가능성 기준을 충족한다는 보장은 없다. 또한, 거래소마다 과금 기준에 대한 정책이 다르다. 대부분의 거래소는 단순히 경매 승리가 아닌, 광고의 전달 또는 렌더링 형태를 기준으로 과금을 진행한다. 이는 구매자가 지불한 광고 노출이 실제로 표시되었는지 확인하려는 목표와 더 잘 부합한다.

일부 거래소는 입찰 성공 알림을 승리한 광고의 마크업에 포함시켜, 이를 입찰 성공 알림과 렌더링 알림으로 동시에 사용하려고 시도한다. OpenRTB는 이를 명시적으로 승인하거나 금지하지 않지만, [4.2.1절](2.6.md#objectbidresponse)에서 설명한 대로, 이 방식은 거래소가 입찰 성공 알림 반환 시 마크업을 수락하는 것을 방해한다. 마찬가지로, 많은 구매자는 OpenRTB 입찰 성공 알림과 독립적으로 렌더링을 신호하기 위해 광고 마크업 내에 자체 추적 URL을 배치한다. 특히 비디오 광고의 경우, VAST는 과금에 자주 사용되며 입찰 성공 알림과 항상 구분되는 노출 추적 URL을 지원한다.

이 개념을 추상화하기 위해, "과금 알림"을 광고 노출의 클리어링 가격이 지출로 기록되는 시점에 발화되는 알림 URL의 실행이라고 지칭하자. 이는 실제 OpenRTB 입찰 성공 알림 URL이 클라이언트에게 위임되어 발화되는지, 아니면 다른 추적 URL이 사용되는지와는 무관하다.

구매자에게 있어, 이 과금 알림은 지출 목표 및 빈도 제한에 대한 진행 상황을 기록하고, 페이싱 알고리즘을 구동하는 데 사용된다. 과금 알림이 크게 지연되면 이러한 핵심 기능이 심각하게 저해될 수 있다. 캐싱과 같은 합당한 이유로 인한 지연도 존재한다. 일반적인 시나리오로는 모바일 앱 내 비디오 인터스티셜 광고 노출이 있다. 예를 들어, 게임 플레이 중에 비디오를 미리 가져와 현재 게임 레벨이 끝난 후에 표시하는 경우를 생각해 보자. 이는 사용자 경험에 중요하지만, 광고 렌더링을 수 분 동안 지연시킬 수 있다.

입찰자는 경매와 입찰 성공 및/또는 과금 알림 사이의 시간을 추적하여 합리적인 지연을 보장해야 한다. 만약 비합리적인 지연이 자주 발생한다면, 입찰자는 해당 이벤트를 무시하고 거래소에 이를 알려 해결을 요청할 수 있다. 불행히도, 광고 요청부터 경매를 거쳐 최종적으로 렌더링 및 과금에 이르는 과정은 기본적으로 트랜잭션이 아니다. 너무 많은 당사자, 정책, 기술이 관여하기 때문에, 거래소와 구매자 간의 좋은 지원 관계가 여전히 중요하다.

그러나 OpenRTB 프로토콜은 실시간 지원을 제공한다. 입찰 요청의 `imp.exp` 속성([3.2.4절](2.6.md#objectimp))은 거래소가 입찰자에게 경매와 과금 이벤트 사이에 경과할 수 있는 시간(초 단위)을 안내할 수 있도록 한다. 이 속성이 생략된 경우 알 수 없음을 의미한다. 입찰자는 이 정보를 바탕으로 지연 가능성을 고려하여 입찰 여부를 결정할 수 있다. 그러나 입찰자는 이를 지침으로 해석해야 하며, 거래소가 명시적으로 표현하지 않는 한 계약으로 간주해서는 안 된다. 거래소가 항상 강력한 보장을 할 수 있는 위치에 있지 않기 때문이다(예: 클라이언트 앱 내 SDK가 거래소의 통제 하에 있지 않을 수 있음).

마찬가지로, 입찰 응답의 `bid.exp` 속성([4.2.3절](2.6.md#objectbid))은 입찰자가 경매와 과금 알림 사이에 허용할 수 있는 최대 시간(초 단위)을 표현할 수 있도록 한다. 이를 통해 거래소는 위반될 가능성이 높은 입찰을 제외할 수 있다. 입찰자는 지정한 입찰 만료 시간보다 지연된 과금 알림이 과금되지 않을 것이라고 가정해서는 안 된다. 이는 입찰자와 거래소 간의 정책 및 계약 논의 사항이며, OpenRTB에 의해 강제되지 않는다.

다음은 광고 노출의 특성에 따른 합리적인 지연 시간의 예시다. 이는 단지 참고용으로 제공되며, 구체적인 상황에서 이러한 시간을 결정하기 위해 데이터 기반 방식을 사용하는 것이 강력히 권장된다.
<table>
  <tr>
	  <td>데스크톱 및 모바일 웹 브라우저</td><td>1분</td></tr>
	<tr>
		<td>캐싱될 수 있는 모바일 앱 배너 광고</td><td>5분</td></tr>
	<tr> 
		<td>캐싱될 수 있는 모바일 앱 네이티브 광고</td><td>10분</td></tr>
	<tr>  
		<td>모바일 및 비디오 인터스티셜</td><td>30분(또는 그 이상)</td></tr>
	<tr>
		<td>서버 측 스티칭이 적용된 오디오 또는 비디오</td><td>매우 길거나 알 수 없음</td></tr>
	</table>


## 7.3 - PMP & 직접 거래 <a name="pmpanddirectdeals"></a>

**최적의 입찰 로직**

요청을 받고 파싱한다;<br>
응답을 위한 빈 입찰 리스트를 생성한다;<br>
요청에 `impression[].pmp` 객체가 포함된 경우, 각 `pmp.deals[]`에 대해 입찰을 매칭한다;<br>
dealID와 seatID에 대한 타겟팅을 적용하고, 가장 적합한 M개의 입찰을 응답에 추가한다;<br>
`pmp.private_auction`이 False인 경우;<br>
오픈 경매 입찰을 요청에 매칭하고, 가격 기준 상위 N개의 입찰을 응답에 추가한다;<br>
응답 리스트를 거래소에 반환한다;<br>

*추천 사항*
- M >= 1, 가능하면 매칭된 Deal ID당 하나씩.
- N >= 2로 설정해 블로킹 비율 문제를 해결.
- 최소한 "1+1" 입찰 방식으로 진행.
- 이상적으로는 "M+N" 입찰 방식.

**경고**

Deal ID와 오픈 경매 입찰이 모두 유효한 경우, 단 하나의 입찰만 반환하면 문제가 발생할 수 있다. 거래소 측에서 출판사가 모든 Deal ID 입찰을 오픈 경매 입찰보다 우선시하도록 설정하거나, 입찰 유형별로 다른 가격 기준을 적용해 경매를 진행하도록 설정할 수 있다. 출판사가 Deal ID로 인벤토리를 판매하는 방식을 어떻게 선호하느냐에 따라 다양한 관행이 존재한다.

**정책 추천**

- 가격 외의 기준으로 입찰이 결정될 수 있는 모든 상황에서 Deal ID를 사용해야 한다. 가격 이외의 기준으로 입찰을 우선시하는 경우 반드시 Deal ID를 적용해야 한다.
- 특정 seat 엔터티에 우선순위 가격 기준이 할당될 수 있는 모든 상황에서 Deal ID를 사용하는 것이 좋다.

**안티 패턴**

아래는 OpenRTB를 지원하는 플랫폼들이 Deal ID 입찰 로직을 구현하는 과정에서 관찰한 안티 패턴들이다.

**Deal ID 입찰을 내부 가격 경매에 적용**

이상적인 입찰 로직은 입찰을 보내는 데 관대한 프로세스를 설명한다. Deal ID 입찰은 전통적인 가격 경매에 적용되지 않을 수 있다. 구매자와 판매자가 Deal ID가 나타내는 거래의 완전한 이행이라는 더 큰 목표를 달성하기 위해 우선순위를 원할 수 있다. 따라서 Deal ID 입찰을 가격 기준으로 정렬하고(오픈 마켓 입찰 포함 여부와 관계없이) 리스트를 지나치게 잘라내는 로직은 거래 이행을 위험에 빠뜨릴 수 있다.

**잘못된 객체에 Deal ID 연결**

Deal ID는 주문, 라인 아이템 또는 캠페인과 연결된 "타겟팅 토큰"으로 취급해야 한다. Deal ID를 Seat/구매자와 연결하면 너무 많은 활성 캠페인에 Deal ID가 적용될 수 있다. 반면 광고주와 연결하면 해당 엔터티가 단 하나의 Deal ID로만 제한될 수 있다.

**Private vs Open Market 플래그의 잘못된 처리**

`pmp.private_auction` 플래그는 판매자가 오픈 마켓 입찰을 받아들일지 여부를 나타낸다. 이 플래그를 올바르게 읽고 해석하지 않으면 입찰 응답이 무효화될 수 있다. 프라이빗 입찰 경매에 오픈 마켓 입찰을 보내면 거부될 수 있으며, 모든 입찰자에게 노출되어서는 안 된다.

**Seat ID의 잘못된 처리**

Seat ID가 오픈 마켓 입찰에서 적격 수요 파트너를 필터링하는 데 사용되면 "모든 입찰자 환영" 의도가 훼손된다.

**Deal ID 입찰에 묵시적 마진 할인 적용**

Deal ID를 사용할 때 구매자와 판매자는 직접 소통한다. 거래소와 입찰자는 제3자 자동화 플랫폼이 된다. 거래소나 입찰자가 마진이나 수수료를 기준으로 입찰 가격에 자동 또는 묵시적 할인을 적용하면 거래가 제대로 작동하지 않을 수 있다.

**사용 사례**

*사례 1: 구매자와의 오픈 거래 계약*

- 출판사와 구매 엔터티 간 계약.
- 출판사가 특정 구매자에 대한 가격 기준을 정의한 접근 규칙 설정.
- 구매자에게 고정.
- 공개 가격 기준.
- 공개/오픈 인벤토리.
- Deal ID 불필요(선택 사항).
- 명시된 광고주 없음.
- 입찰 우선순위 없음.
- 출판사/거래소 측에서 일일 총량 또는 빈도 제한 선택 사항.
- 모든 배치 또는 특정 배치로 제한.
- 타겟팅은 구매자/입찰자에게 위임.

*사례 2: 명시된 광고주와의 오픈 거래 계약*

- 사례 1과 동일하지만 명시된 광고주 리스트 포함.

*사례 3: Deal ID를 부가 가치 마커로 사용한 오픈 입찰*

- 출판사와 구매 엔터티 간 계약.
- 출판사가 URL 마스킹된 인벤토리에 대한 가격 기준 설정.
- 공개/오픈 인벤토리(즉, 모든 구매자 환영).
- Deal ID는 "패키지 토큰"을 나타냄.
- 각 Deal ID는 해당 광고 노출이 다양한 콘텐츠 및 배치 카테고리에 속함을 나타냄.
- 각 Deal ID에 가격 기준을 연결해 토큰 사용 비용을 나타냄.
- 입찰 가격으로 승자 결정.
- 타겟팅 실행은 구매자/입찰자에게 위임.

*사례 4: 퍼스트 룩 거래 계약*

- 출판사와 구매 엔터티 간 계약.
- 출판사가 구매자에 대한 가격 기준을 정의한 접근 규칙 설정.
- 구매자에게 고정.
- 알려진 가격 기준.
- Deal ID 필요.
- 명시된 광고주 리스트 선택 사항.
- 입찰 우선순위 예상.
- 출판사/거래소 측에서 일일 총량 또는 빈도 제한 선택 사항.
- 모든 배치 또는 특정 배치로 제한.
- 타겟팅은 구매자/입찰자에게 위임.

*사례 5: RTB를 통한 광고주와의 직접 옵션 거래*

- 출판사와 광고주 또는 그 대리자 간 계약.
- 출판사가 특정 광고주(들)에 대한 가격 기준과 우선순위를 정의한 규칙 설정.
- 채우기 비율이 X% 이상일 것으로 예상.
- 구매자에게 고정.
- 프라이빗/독점 인벤토리.
- 명시된 광고주 리스트로 제한(일반적으로 한 이름의 변형).
- 알려진 가격 기준.
- Deal ID 필요.
- 입찰 우선순위 예상.
- 입찰자 측에서 일일 총량 또는 빈도 제한 적용; 거래소 측에서 선택 사항.
- 특정 배치로 제한.
- 타겟팅은 주로 구매자/입찰자가 실행.

*사례 6: 프라이빗 데이터와 함께 RTB를 통한 광고주와의 직접 옵션 거래*

- 사례 4와 동일.
- Deal ID는 출판사의 프라이빗 퍼스트파티 데이터 조합을 나타냄.

*사례 7: RTB를 통한 광고주와의 완전 채우기 직접 거래*

- 사례 4와 동일.
- 채우기 비율이 100% 또는 거의 그에 가까울 것으로 예상.

*사례 8: 프라이빗 데이터와 함께 RTB를 통한 광고주와의 완전 채우기 직접 거래*

- 사례 6과 동일.
- Deal ID는 출판사의 프라이빗 퍼스트파티 데이터 조합을 나타냄.


## 7.4 - 광고 건너뛰기 기능 <a name="skippability"></a>

이 섹션에서는 비디오 광고의 건너뛰기 기능을 선언하는 것과 관련된 일반적인 사용 사례를 설명한다.

대부분의 RTB 거래 상황에서, 퍼블리셔와 광고 교환 플랫폼은 광고 건너뛰기 기능을 직접 제어하는 것을 선호한다. 따라서 OpenRTB는 기본적으로 건너뛰기 요청에 대한 응답으로 표준 선형 비디오 광고를 사용할 수 있으며, 건너뛰기 기능은 공급자의 플레이어에서 자동으로 제공된다고 가정한다.

입찰 요청에서 `video.skip` 속성이 "1"로 설정되어 있으면, 퍼블리셔가 광고에 건너뛰기 버튼을 추가할 것이라고 가정해야 한다. `video.skip` 속성이 없으면 퍼블리셔가 건너뛰기 버튼을 추가할지 여부가 알려지지 않았다고 가정해야 한다.

DSP는 퍼블리셔와 협의하여 자체 건너뛰기 기능을 제공하는 광고(예: VPAID를 사용해 건너뛰기 버튼을 렌더링하는 광고)로 응답해도 되는지 확인해야 한다. 이러한 광고로 입찰할 경우, 입찰 응답의 `attr` 배열에 "16"번 크리에이티브 속성을 표시해야 한다.

*<b>참고</b>: VAST 4.0은 VPAID 상호작용을 미디어 파일과 분리했기 때문에 이 방식은 더 이상 사용되지 않으며, VAST의 이전 버전에만 적용된다.*

다음은 이러한 개념의 예제들이다:

**입찰 요청**

*케이스 1: 모든 광고에 대해 N초 후 건너뛰기 가능*

이 경우, 퍼블리셔가 건너뛰기 기능을 추가한다. 모든 광고는 5초 재생 후 건너뛸 수 있다. 총 재생 시간이 5초 이하인 광고는 이 임계값에 도달할 수 없기 때문에 건너뛸 수 없다.

```javascript
"video": {
	
..., 
 "skip": 1, 
 "skipafter": 5, 
 ...
	
}
```

*케이스 2: 최소 재생 시간을 가진 광고에 대해 N초 후 건너뛰기 가능*

이 경우, 퍼블리셔가 건너뛰기 기능을 추가한다. 그러나 총 재생 시간이 15초를 초과하는 광고만 건너뛸 수 있다. 이 최소 재생 시간을 충족하는 광고는 5초 재생 후 건너뛸 수 있다. 이 값들은 정수이지만, 실제 비디오 재생 시간과 정확히 비교된다. 예를 들어, 15.1초 길이의 비디오는 `skipmin` 값 15를 충족한다(`skipmin` 값을 15.0으로 생각하면 된다).

```javascript
"video": {
	
...,
"skip": 1, 
"skipmin": 15, 
"skipafter": 5, 
...
	}
```

*케이스 3: 광고 마크업에서 요청하지 않는 한 건너뛸 수 없음*

이 경우, 퍼블리셔가 건너뛰기 기능을 추가하지 않는다. 광고 마크업에서 요청한 경우에만 광고를 건너뛸 수 있다. 이는 VPAID와 VAST 3.0에서 지원된다.

```javascript
"video": {
	
...,
"skip": 0, 
...
	
}
```

*케이스 4: 건너뛰기 가능 여부 알 수 없음*

이 경우, `skip` 속성이 생략되어 있어 교환 플랫폼이 퍼블리셔가 건너뛰기 기능을 추가할지 여부를 알 수 없다. 예를 들어, 교환 플랫폼이 SSP가 아닌 경우 퍼블리셔의 의도를 제어하거나 완전히 알지 못할 수 있다.

**입찰 응답**

위의 케이스 3을 고려해 보자. 퍼블리셔가 건너뛰기 기능을 추가하지 않는다면, 광고 마크업 자체에서 건너뛰기를 요청하는 경우(예: VPAID 또는 VAST 3.0을 통해) 입찰에서 이 의도를 표시해야 한다. 이는 아래와 같이 입찰에 "16"번 크리에이티브 속성(즉, 건너뛰기 가능)을 포함해 수행된다. 마크업이 건너뛰기를 요청하지 않는다면 이 크리에이티브 속성을 표시하지 않아야 한다.

이 건너뛰기 속성이 지정된 입찰로 케이스 3에 응답할 때, 퍼블리셔는 VAST 3.0 플레이어에게 건너뛰기 기능을 활성화하도록 지시하거나(VAST 3.0 `skipoffset` 속성 참조), VPAID를 사용해 광고가 자체 건너뛰기 버튼을 렌더링하도록 허용해야 한다.

```javascript
"bid": {
	
..., 
"attr": [16], 
...
	
}
```

퍼블리셔가 자체적으로 건너뛰기 기능을 추가할 수 있는 케이스 1과 케이스 2에서는 크리에이티브 속성 16을 지정하지 않아야 한다. 또한, 퍼블리셔는 속성 16이 포함된 응답을 필터링하는 것이 좋다. 이는 퍼블리셔가 렌더링한 건너뛰기 버튼과 충돌할 수 있기 때문이다. VAST 3.0 응답을 사용할 때, 퍼블리셔는 VAST 3.0 `skipoffset` 지원을 자유롭게 구현할 수 있으며, 플레이어가 이를 지원하지 않으면 광고가 건너뛸 수 없이 재생된다고 가정해야 한다.


## 7.5 - 규제 리소스 <a name="regsresources"></a>

regs 객체는 요청과 관련된 법적, 정부, 또는 산업 규제 정보를 포함한다. 발신자가 해당 요청에 적용 가능하다고 판단한 규제 정보를 담는다.

아래 리소스에서 더 자세한 내용과 프레임워크 사양을 확인할 수 있다. 이를 구현하려는 경우 참고하면 된다:

**<a href="https://github.com/InteractiveAdvertisingBureau/GDPR-Transparency-and-Consent-Framework">GDPR (일반 데이터 보호 규정)</a>**

**<a href="https://github.com/InteractiveAdvertisingBureau/USPrivacy">CCPA (캘리포니아 소비자 개인 정보 보호법)</a>**


## 7.6 - 비디오 및 오디오 포드 입찰 <a name="podbidding"></a>

버전 2.6부터 OpenRTB는 비디오 및 오디오 콘텐츠 스트림에 대한 '포드 입찰'을 지원한다.  
포드(ad pod)는 TV 시청 경험에서 볼 수 있거나 라디오 스트림에서 들을 수 있는 광고 브레이크를 의미한다. 일반적으로 하나 이상의 인스트림 광고 자산이 포함되며, 비디오나 오디오 콘텐츠 스트림 내에서 연속적으로 재생된다. OpenRTB 2.6의 포드 기능은 이전 버전의 기능을 기반으로 하여, 단일 입찰 요청 객체 내에 여러 광고 요청을 포함하고 이러한 광고 요청이 서로 관련이 있음을 나타낸다. 포드 입찰 시그널은 광고 노출 순서, 전체 포드 길이, 포드 내 최대 광고 수, 다중 포드 연관 등과 같은 추가 정보를 전달한다.  

**용어 설명**  

- **광고 슬롯(Ad Slot)**: 포드 내 개별 광고 노출을 위한 공간  
- **구조화된 포드(Structured Pod)**: 판매자가 완전히 정의된 포드 구조를 제공한다. 광고 슬롯의 수, 포드 내 위치, 지속 시간이 미리 정의되고 고정된다.  

![](assets/structured_pod.png)  

- **동적 포드(Dynamic Pod)**: 판매자가 광고 수와 각 광고의 지속 시간이 결정되지 않았지만, 전체 지속 시간과 최대 광고 수가 제한된 포드 구조를 제공한다. 즉, 포드의 전체 지속 시간은 알려져 있지만, 브레이크 내 개별 광고의 수와 지속 시간은 미리 정의되지 않는다. 이를 통해 입찰자는 플랫폼의 수요에 맞춰 광고 선택을 최적화할 수 있는 유연성을 가진다.  

![](assets/dynamic_pod.png)  

- **하이브리드 포드(Hybrid Pod)**: 판매자가 구조화된 구성 요소와 동적 구성 요소를 모두 포함하는 포드 구조를 제공한다. 즉, 포드는 미리 정의된 지속 시간을 가진 광고 슬롯과 전체 지속 시간 및 최대 광고 수에 의해 제한된 광고 슬롯의 조합으로 구성된다.  

![](assets/hybrid_pod.png)  

**권장 사항**  

- 판매자는 첫 번째 또는 마지막 슬롯에 광고를 배치할 수 있다고 절대적으로 확신할 때만 `slotinpod`를 1, 2 또는 -1로 표시해야 한다.  
- 구매자는 동적 포드 세그먼트(하이브리드 포드의 동적 구성 요소 포함)에 대해 첫 번째 또는 마지막 광고 슬롯만 구매하려는 경우에만 `slotinpod`를 표시해야 한다.  
- 구매자는 포드의 동적 부분에 대해서만 `slotinpod` 값을 반환해야 한다.  
- 구매자는 구조화된 포드 또는 하이브리드 포드의 구조화된 구성 요소에 대한 입찰 응답에서 `slotinpod` 속성을 사용하지 않아야 한다. `impid` 필드가 이미 광고 슬롯을 고유하게 식별하기 때문이다.  
- 구매자는 가능한 경우 `mincpmpersec`를 찾고, 그렇지 않으면 `bidfloor`로 대체해야 한다.  
- 판매자는 정확한 지속 시간을 전달하는 `rqddurs` 속성 또는 `maxduration` 및 `minduration` 속성 중 하나를 포함해야 하지만 둘 다 포함하지는 않는다.  
- 판매자는 포드 지속 시간과 함께 동적 포드를 제공할 때 `maxseq` 속성을 포함하는 것이 좋다.  
- 판매자는 가능한 경우 동적 포드를 제공하여 입찰자가 플랫폼에서 가장 최적의 수요를 확보할 수 있도록 하는 것이 좋다.  
- 구매자는 최종 포드 구성이 판매자에 의해 완료된다는 점을 이해해야 한다. 특정 포드에 대해 N개의 입찰을 제출한 구매자는 판매자가 사용자에게 보여줄 포드를 구성하기 위해 0에서 N 사이의 입찰을 선택할 수 있다는 점을 알아야 한다. 또한 판매자는 해당 포드에 다른 구매자의 입찰을 혼합할 수 있다.  

**포드 입찰 예제 시나리오**  

*"구조화된" 포드 요청/응답*  

이 시나리오는 입찰 요청에 2개의 구조화된 포드가 포함되고, 응답이 2개의 표시된 포드 각각의 첫 번째 위치에 해당하는 예제를 보여준다.  

```javascript
BidRequest

{ "imp": 

	[{ "id": "1", 

	"video": { 

		"podid": "pod_1", 

		"podseq”: 1, 

		"slotinpod": 1, 

		"mimes": [ 

			"video/mp4", 

			"video/ogg", 

			"video/webm" 

		], 

		"linearity": 1, 

		"maxduration": 60, 

		"minduration": 0, 

		... 

	}, 
	"exp": 7200, 

	"bidfloor": 8, 

	"bidfloorcur": "USD", 

	}, 

	{ 

		"id": "2", 

		"video": { 

			"podid": "pod_1", 

			"podseq": 1, 

			"slotinpod": 0, 

			"mimes": [ 
			
				"video/mp4", 

				"video/ogg", 

				"video/webm" 
			], 
			"linearity": 1, 
			
			"maxduration": 30, 

			"minduration": 0, 

			... 

		}, 

		"exp": 7200, 

		"bidfloor": 8, 

		"bidfloorcur": "USD", 

		...

	}, 

	{ 

		"id": "3", 

		"video": { 

			"podid": "pod_2", 

			"podseq": 0, 

			"slotinpod": 1, 

			"mimes": [ 

				"video/mp4", 

				"video/ogg", "

				video/webm" 

			], 

			"linearity": 1, 

			"maxduration": 30, 

			"minduration": 0, 

			... 

		}, 

		"exp": 7200, 

		"bidfloor": 8, 

		"bidfloorcur": "USD", 

		... 

		}, 

		{ 

			"id": "4", 

			"video": { 

				"podid": "pod_2", 

				"podseq": 0, 

				"slotinpod": 0, 

				"mimes": [ 

					"video/mp4", 

					"video/ogg", 

					"video/webm" 

				], 

				"linearity": 1, 

				"maxduration": 60, 

				"minduration": 0, 

				... 

			},

			"exp": 7200, 

			"bidfloor": 8, 

			"bidfloorcur": "USD", 

			... 

		} 

	], 

	... 

}
```

```javascript
BidResponse

{ 
	"id": "9b9ee818a85d948d5231ffe839a9729a", 

	"seatbid": [{ 

		"bid": [{

			"id": "1", 

			"impid": "1", 

			"price": 0.27, 

			"adid": "123456", 

			"adm": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><VAST version=\"2.0\"> ...", 

			"adomain": [ 

				"advertiserA.com" 

			], 

			"cid": "456789", 

			"crid": "123456", 

			"dur": 30 

		}], 

		"seat": "1"

	}, 

	{ 

		"bid": [{ 

			"id": "2", 

			"impid": "3", 

			"price": 0.27, 

			"adid": "234567", 

			"adm": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><VAST version=\"2.0\"> ...", 

			"adomain": [ 

				"advertiserB.com" 

			], 

			"cid": "567890", 

			"crid": "234567", 

			"dur": 15 

		}], 

		"seat": "2" 

	} 

	], "cur": "USD" }

```

*"동적" 포드 요청/응답*  

이 시나리오는 입찰 요청에 1개의 동적 포드가 포함되고, 게시자가 첫 번째 또는 마지막 슬롯에 대한 전달을 보장할 수 있으며, 응답이 표시된 포드에 대해 3개의 다른 광고주로부터 3개의 입찰을 포함하는 예제를 보여준다. 응답의 첫 번째 입찰은 포드의 첫 번째 위치에만 적합하다.  

```javascript
BidRequest

{

	"imp": [{

		"id": "1",
		
		"video": {
		
			"podid": "preroll_pod",
			
			"mimes": [
			
				"video/mp4",
				
				"video/ogg",
				
				"video/webm"
				
			],
			
			"linearity": 1,
			
			"maxduration": 60,
			
			"minduration": 0,
			
			"maxseq": 4,
			
			"poddur": 60,
			
			"slotinpod": 2,
			
			...
			
		},
		
		"exp": 7200,
		
		"bidfloor": 8,
		
		"bidfloorcur": "USD",
		
		...
		
	}],
	
	...
	
}
```

```javascript
BidResponse

{

	"id": "9b9ee818a85d948d5231ffe839a9729a",
	
	"seatbid": [{
	
			"bid": [{
			
				"id": "1",
				
				"impid": "1",
				
				"price": 0.27,
				
				"adid": "123456",
				
				"adm": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><VAST version=\"2.0\"> ...",
				
				"adomain": [
				
					"advertiserA.com"
					
				],
				
				"cid": "456789",
				
				"crid": "123456",
				
				"slotinpod": 1,
				
				"dur": 30
				
			}],
			
			"seat": "1"
			
		},
		
		{
		
			"bid": [{
			
				"id": "2",
				
				"impid": "1",
				
				"price": 0.27,
				
				"adid": "234567",
				
				"adm": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><VAST version=\"2.0\"> ...",
				
				"adomain": [
				
					"advertiserB.com"
					
				],
				
				"cid": "567890",
				
				"crid": "234567",
				
				"dur": 15
				
			}],
			
			"seat": "1"
			
		},
		
		{
		
			"bid": [{
			
				"id": "3",
				
				"impid": "1",
				
				"price": 0.27,
				
				"adid": "345678",
				
				"adm": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><VAST version=\"2.0\"> ...",
				
				"adomain": [
				
					"advertiserC.com"
					
				],
				
				"cid": "678901",
				
				"crid": "345678",
				
				"dur": 15
				
			}],
			
			"seat": "2"
			
		}
		
	],
	
	"cur": "USD"
	
}
```

*"하이브리드" 포드 요청/응답*  

이 시나리오는 입찰 요청에 첫 번째 임프레션 객체에서 슬롯 1과 지속 시간을 채우기 위한 동적 포드가 포함되고, 응답이 표시된 포드에 대해 3개의 다른 광고주로부터 3개의 입찰을 포함하는 예제를 보여준다. 응답의 첫 번째 입찰은 포드의 첫 번째 위치에만 적합하며, 두 번째와 세 번째 응답은 포드의 나머지 부분을 채우기 위한 것이다.  

```javascript
BidRequest

{

	"imp": [{
	
			"id": "1",
			
			"video": {
			
				"podid": "pod_1",
				
				"slotinpod": 1,
				
				"mimes": [
				
					"video/mp4",
					
					"video/ogg",
					
					"video/webm"
					
				],
				
				"linearity": 1,
				
				"maxduration": 15,
				
				"minduration": 15,
				
				...
				
			},
			
			"exp": 7200,
			
			"bidfloor": 15,
			
			"bidfloorcur": "USD",
			
			...
			
		},
		
		{
		
			"id": "2",
			
			"video": {
			
				"podid": "pod_1",
				
	"slotinpod": 0,
	
				"mimes": [
				
					"video/mp4",
					
					"video/ogg",
					
					"video/webm"
					
				],
				
				"linearity": 1,
				
				"maxduration": 60,
				
				"minduration": 0,
				
				"maxseq": 4,
				
				"poddur": 60,
				
	                             ...
				     
			},
			
			"exp": 7200,
			
			"bidfloor": 8,
			
			"bidfloorcur": "USD",
			
			...
			
		}
		
	}],
	
	...
	
}
```

```javascript
BidResponse

{

	"id": "9b9ee818a85d948d5231ffe839a9729a",
	
	"seatbid": [{
	
			"bid": [{
			
				"id": "1",
				
				"impid": "1",
				
				"price": 20.27,
				
				"adid": "123456",
				
				"adm": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><VAST version=\"2.0\"> ...",
				
				"adomain": [
				
					"advertiserA.com"
					
				],
				
				"cid": "456789",
				
				"crid": "123456",
				
				"dur": 15
				
			}],
			
			"seat": "1"
			
		},
		
		{
		
			"bid": [{
			
				"id": "2",
				
				"podid": "pod_1",	
				
				"impid": "2",
				
				"price": 9.27,
				
				"adid": "234567",
				
				"adm": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><VAST version=\"2.0\"> ...",
				
				"adomain": [
				
					"advertiserB.com"
					
				],
				
				"cid": "567890",
				
				"crid": "234567",
				
				"dur": 15
				
			}],
			
			"seat": "1"
			
		},
		
		{
		
			"bid": [{
			
				"id": "3",
				
				"podid": "pod_1",
				
				"impid": "2",
				
				"price": 10.27,
				
				"adid": "345678",
				
				"adm": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><VAST version=\"2.0\"> ...",
				
				"adomain": [
				
					"advertiserC.com"
					
				],
				
				"cid": "678901",
				
				"crid": "345678",
				
				"dur": 15
				
			}],
			
			"seat": "2"
			
		}
		
	],
	
	"cur": "USD"
	
}
```


## 7.7 - 네트워크와 채널 예제 사례 <a name="networkandchannel"></a>

OpenRTB 2.6 버전부터 네트워크와 채널 객체를 지원한다. 자세한 내용은 [3.2.23](2.6.md#objectnetwork)과 [3.2.24](2.6.md#objectchannel)을 참고한다. 전통적인 선형 TV에서는 이 개념이 직관적이지만, CTV(Connected TV) 콘텐츠 소비를 위한 옵션은 몇 가지 예제를 통해 살펴볼 필요가 있다.

*예제 1*: 인터넷 연결 기기에서 여러 채널 옵션을 제공하는 앱을 통해 콘텐츠를 시청하는 경우 (예: Discovery+ 앱 > HGTV 채널/프로그램)
- Discovery는 네트워크
- HGTV는 채널

*예제 2*: 인터넷 연결 기기에서 콘텐츠를 직접 스트리밍하는 앱을 통해 시청하는 경우 (Roku > Hulu > Hulu 오리지널 프로그램)
- Hulu는 네트워크 (`bundle`로도 식별됨)
- Hulu는 채널

*예제 3*: 인터넷 연결 기기에서 기기가 제공하는 채널을 통해 콘텐츠를 시청하는 경우 (Roku > Fubo > Comedy Central 프로그램)
- Roku는 기기
- FuboTV는 네트워크 (`bundle`로도 식별됨)
- Comedy Central은 채널

*예제 4*: 인터넷 연결 기기에서 콘텐츠를 라이선스하는 기기 제공 채널을 통해 시청하는 경우 (Samsung TV > Pluto > Pluto TV Spotlight)
- Samsung TV는 기기
- Pluto는 네트워크 (`bundle`로도 식별됨)
- PlutoTV Spotlight는 채널


## 7.8 - 과금 이벤트와 추적 광고 카운팅 <a name="counting"></a>

OpenRTB를 통해 과금 이벤트나 추적 광고를 카운팅하는 방법에는 여러 가지 관례가 있다. 주로 노출수(impression)와 같은 일반적인 지표를 사용한다. 이 섹션에서는 일반적인 방법들을 소개하고, 흔히 발생하는 실수들을 짚어보며, 각 접근 방식의 비교를 제공한다.

이 섹션에서는 구현자가 이러한 이벤트를 소비할 수 있는 기술적 방법을 다룬다. 이러한 이벤트는 Media Rating Council이 정한 특정한 비즈니스 정의와 카운팅 자격 기준을 가지고 있으며, 구현자는 [Media Rating Council의 가이드라인](https://mediaratingcouncil.org/standards-and-guidelines)도 참고해야 한다.

구현자는 과금 이벤트의 정의와 이를 카운팅하는 기술적 기준을 상대방과 논의하여 상호 합의할 수 있는 접근 방식을 결정해야 한다.

**카운팅 방법론 개요**

<table>
  <tr>
    <td><strong>방법</strong></td>
    <td><strong>비고</strong></td>
  </tr>
  <tr>
    <td>마크업 내 픽셀</td>
    <td>- 널리 지원됨<br>
	- 일반적으로 클라이언트 측 브라우저에서 실행됨<br>
	- 불일치가 발생하기 쉬움<br>
	- 특정 상황(예: 모바일 앱)에서 과다 카운팅 가능<br>
	- 디스플레이 광고에만 적용 가능</td>
  </tr>
  <tr>
    <td>VAST <impression> 이벤트</td>
    <td>- 오디오/비디오에 권장됨<br>
	- 오디오/비디오에만 적용 가능</td>
 </tr>
  <tr>
    <td>과금 알림 ("burl")</td>
    <td>- DSP와 거래소 간 추적 광고 카운팅에 가장 적합<br>
	- 최소한의 불일치<br>
	- 오디오/비디오에는 권장되지 않음, 그 외 모든 크리에이티브 타입에 적용 가능<br>
	- 일반적으로(권장됨) 서버 간에 실행되지만, 초기 클라이언트 측 이벤트를 기반으로 함</td>
</tr>
  <tr>
    <td>네이티브 eventtrackers/imptrackers/jstrackers</td>
    <td>- 네이티브 광고에만 적용 가능</td>
  </tr>
</table>

**마크업 내 픽셀 (배너 광고)**

이 방법은 노출수/추적 광고를 카운팅하는 원래의 관례로, OpenRTB 명세 자체는 이벤트를 어떻게 받을지 다루지 않는다. 입찰자는 HTML 마크업에 트래킹 픽셀을 직접 삽입한다(예: 입찰자 서버에 요청을 보내는 <img> 태그). 클라이언트 디바이스가 마크업을 로드하면 픽셀이 실행된다.

웹 배너 광고의 경우, 이 방법은 과금 이벤트/추적 광고를 카운팅하는 데 널리 사용되지만, 불일치가 발생할 수 있는 상황이 있다. 거래소와 DSP의 픽셀 로드 타이밍 차이로 인해 불일치가 발생할 수 있으며, 공용 인터넷의 잡음과 클라이언트 디바이스의 연결 품질 변동으로 인해 한 픽셀은 실행되지만 다른 픽셀은 실행되지 않을 수 있다. 또한 이 방법은 다음과 같은 특정 시나리오를 잘 처리하지 못한다:

- **모바일 앱** – 광고가 실제로 표시될 때만 과금 이벤트가 카운팅될 수 있다. 모바일 앱에서는 마크업이 실제로 표시되기 훨씬 전에 미리 가져와 느리고 불안정한 연결에 대비한다. 사용자가 광고가 표시되기 전에 앱을 종료하면 마크업이 전혀 표시되지 않을 수 있다 – 특히 인터스티셜 광고의 경우.

- **크리에이티브 감사** – 마크업이 악성 광고 등을 스캔하기 위해 로드될 수 있으며, 이는 낙찰되지 않은 경매를 포함해 불필요한 추가 과금/추적 광고 이벤트를 생성할 수 있다.

**모범 사례**: 가능한 경우, 거래소는 모바일 앱 컨텍스트에서 과금 이벤트를 결정하는 데 adm 기반 알림을 사용하지 말고, 대신 광고가 실제로 사용자에게 표시되었음을 전제로 하는 burl 또는 독립적인 측정 방식을 사용해야 한다.

**VAST <Impression> 이벤트 (비디오/오디오)**

VAST 명세에는 <Impression> 객체에 대한 규정이 포함되어 있으며, 수요 체인 참여자는 과금 이벤트가 발생했을 때 알림을 요청할 수 있다. IAB는 비디오의 경우 VAST <Impression> 이벤트가 과금 이벤트가 발생했음을 알리는 공식 신호라고 규정한다.

수요 체인 참여자는 비디오/오디오 거래에 과금 알림 URL(burl)을 사용하지 않는 것이 좋다.

**과금 알림 (“burl”)**

과금 알림 지원은 OpenRTB 2.5에서 도입되었다. 이 시나리오에서는 광고 마크업 자체가 아닌 **외부**에 "과금 알림 URL"이 입찰 응답에 포함된다. 과금 이벤트는 거래가 발생하여 게시자로부터 거래소로, 그리고 거래소나 다른 중개자로부터 수요 측 파트너 중 하나로 금전적 청구가 이루어지는 시점이다. 이 이벤트는 게시자와 거래소의 특정 비즈니스 정책에 따라 달라지며, 이는 파트너에게 명확히 전달되어야 한다. DSP의 경우, 이 이벤트는 관련 캠페인의 지출을 증가시키고 남은 예산을 차감할 수 있다는 신호이다. 거래소는 bid.burl 속성에 제공된 URL을 호출하여 이 이벤트를 전달한다.

**모범 사례**: 과금 알림 URL을 실행하는 것은 게시자와 거래소 또는 거래소와 수요 파트너 간의 비즈니스 거래가 완료되었음을 나타낸다. 이는 클라이언트 측 픽셀을 포함한 다른 당사자에게 위임해서는 안 되지만, 픽셀이 거래소에 과금을 시작하는 신호가 될 수는 있다.

**모범 사례**: 거래소는 과금 이벤트가 발생했음을 확인한 후(예: 클라이언트 시작 과금 이벤트 수신), 수요 소스와의 불일치를 최소화하기 위해 서버 측에서 과금 알림을 실행해야 한다. 이는 거래소가 수익을 기록하는 시점에 최대한 가깝게 이루어져야 한다. 서버 측 과금 알림에 대한 모범 사례는 아래 섹션을 참조한다.

**모범 사례**: 거래소는 클라이언트 시작 렌더링 또는 가시성 이벤트를 과금 이벤트의 기준으로 표준화하는 것이 좋다. 이는 일반적으로 여러 경매 결정 지점으로 구성된 복잡한 공급 체인 시나리오에서 가장 일관된 접근 방식이다.

**모범 사례**: 게시자는 일반적으로 [Media Rating Council의 가이드라인](https://mediaratingcouncil.org/standards-and-guidelines)을 참조하여 거래가 과금 가능한 기준을 충족했는지 확인해야 한다.

**모범 사례**: 공용 인터넷은 잡음이 많고 이 이벤트는 재정적 성격을 띤다. 과금 알림을 호출하는 엔티티가 HTTP 200 또는 204 이외의 응답을 받으면 재시도 방안을 고려해야 한다(예: 다음 1분 동안 10초마다). 반대로, 과금 알림을 받는 엔티티는 이중 카운팅을 피하기 위해 엔드포인트를 멱등성(idempotent)으로 만들기 위해 노력해야 한다.

**모범 사례**: 가능한 경우, 거래소는 모바일 앱 컨텍스트에서 과금 이벤트를 결정하는 데 adm 기반 알림을 사용하지 말고, 대신 광고가 실제로 사용자에게 표시되었음을 전제로 하는 burl 또는 독립적인 측정 방식을 사용해야 한다.

VAST 비디오/오디오의 경우, `bid.burl` 속성이 지정되면 VAST <Impression> 이벤트와 동시에 실행되어야 한다. 그러나 미묘한 기술적 문제로 인해 추가 불일치가 발생할 수 있으며, 입찰자는 이 시나리오를 피하는 것이 좋다. 한 가지 옵션은 비디오 공급 소스에 가장 가까운 거래소가 VAST <Impression> 이벤트를 과금 신호로 사용한 후, 과금 알림 URL(burl)을 설명된 대로 사용하는 것이다.

**네이티브 eventtrackers, imptrackers, jstrackers**

특히 네이티브 광고의 경우, OpenRTB 네이티브 명세는 노출 시점에 로드할 노출 추적 URL이나 스크립트를 포함할 수 있는 옵션을 제공한다. 자세한 내용은 [OpenRTB 네이티브](https://iabtechlab.com/standards/openrtb-native/) 명세를 참조한다. 네이티브 비디오의 경우, 대부분의 플랫폼은 네이티브 명세 내의 구조화된 추적 옵션보다 VAST 내의 노출 이벤트를 과금 및 기타 이벤트 알림에 사용한다.

**낙찰 알림 (“nurl”) – 과금 또는 추적 광고 이벤트가 아님**

언뜻 보기에 경매 "낙찰"과 관련된 낙찰 알림(`nurl`) 필드는 과금/추적 광고 카운팅의 대리 지표로 적합해 보인다. 그러나 경매에서 승리한다고 해서 노출이 실제로 제공될 것이라는 보장은 없으며, 실제로 많은 경우 낙찰된 경매 중 일부만 노출로 이어질 수 있다. 이는 다운스트림 경매(예: 클라이언트 측 헤더 입찰), 미디어 재생 불가(비디오 및 오디오) 등으로 인해 발생한다.

**낙찰 알림 URL은 절대로 노출수나 추적 광고를 카운팅하는 데 사용해서는 안 된다.**


### 서버 측 청구 알림을 위한 모범 사례

경우에 따라 퍼블리셔나 벤더가 서버에서 노출 알림을 보내는 방식을 선택할 수 있다. 이는 장편 동영상에서 흔히 사용되는데, 서버 측 광고 삽입(SSAI)을 통해 사용자 기기의 '씬' 클라이언트에게 광고 전달과 측정을 조정한다. 또한 모바일 앱에서도 자주 사용되는데, 여기서는 수익화 SDK가 서버 측 서비스를 통해 청구 알림 URL(burl)을 보낸다.

다음 모범 사례는 [VAST 4.2 사양](https://iabtechlab.com/wp-content/uploads/2019/06/VAST_4.2_final_june26.pdf)(17페이지)에서 가져왔지만, 모든 노출 알림(프로토콜이나 버전에 관계없이 모든 형식에 대해)에 권장된다.

**모범 사례**: 가능한 경우, 교환 플랫폼은 수요 파트너와의 불일치를 최소화하기 위해 서버 측에서 청구 알림 URL(burl)을 보내는 것이 좋다. 청구 가능 이벤트 자체는 MRC 가이드라인에 따라 클라이언트 측 이벤트에서 발생해야 한다.

**모범 사례**: 서버 측에서 HTTP 요청을 통해 노출 알림을 보낼 때, 알림 발송자는 다음을 준수해야 한다:

- X-Forwarded-For 또는 X-Device-IP HTTP 헤더를 사용해 알림을 대신 보내는 클라이언트 기기의 IP 주소를 표시한다.
- X-Device-User-Agent HTTP 헤더를 사용해 알림을 대신 보내는 클라이언트 기기의 UserAgent를 표시한다.

이러한 HTTP 헤더를 사용하면 노출 알림 수신자가 서버 자체가 아닌 최종 사용자 기기에 대한 메타데이터를 사용해 반-사기 방지 검사를 실행할 수 있다.

**모범 사례**: 서버 측에서 HTTP 요청을 통해 노출 알림을 보낼 때, 알림 발송자는 [ads.cert Call Sign](https://iabtechlab.com/wp-content/uploads/2021/09/2-ads-cert-call-signs-pc.pdf)을 설정하고 [ads.cert Authenticated Connections 프로토콜](https://iabtechlab.com/wp-content/uploads/2021/09/3-ads-cert-authenticated-connections-pc.pdf)을 사용해 알림에 암호화된 서명을 추가해야 한다. 이를 통해 노출 알림 수신자가 자신의 ads.cert Call Sign을 설정한 경우, 발신자를 인증해 사기 방지 목적으로 사용할 수 있다.


## 7.9 - 디지털 아웃오브홈(DOOH) <a name="dooh"></a>

이 섹션에서는 디지털 디스플레이의 온라인 세계와 디지털 아웃오브홈(DOOH) 미디어의 실제 세계 간의 고유한 차이점을 자세히 설명한다. 각 하위 섹션은 OpenRTB 표준을 사용해 DOOH를 거래할 수 있게 하는 주요 객체를 참조한다.


### 7.9.1 - 다중/가변 노출

OpenRTB 거래 방식은 타겟팅된 사용자가 하나의 기기를 가지고 있으며 웹페이지를 방문할 때 하나의 광고를 제공받는다는 가정에 기반을 두고 있다. 즉, 하나의 노출은 하나의 사용자에 해당한다. 

OOH 미디어는 하나의 광고 재생(스팟)이 광고가 표시되는 주변에 있는 모든 사람에게 보여지는 매체이다. 이 경우 하나의 광고 표시는 여러 명의 시청자/사용자에게 노출된다. 이 숫자는 1보다 크거나 작을 수 있으며, 통계 모델링을 기반으로 하기 때문에 소수 값(예: 광고 표시당 0.32 노출)이 일반적이다. 이러한 비율은 시간에 따라 조정된 예측이나 실시간 센서 데이터를 기반으로 변동할 수 있다.

소수 값을 곱할 때(특히 CPM의 경우) '구매 측'과 '판매 측'이 소수점 이하를 잘라내는 경우 불일치가 발생할 수 있다. 이를 방지하기 위해 계정 수준에서 조치를 취해야 한다.

OpenRTB의 imp 객체에는 이제 배수 차원을 가능하게 하는 qty 객체가 포함되어 있다.


### 7.9.2 고유한 기기 특성

#### 7.9.2.1 물리적 크기의 다양성

OpenRTB를 통해 광고가 제공되는 대부분의 기기는 한 사람이 들거나 기대어 사용할 수 있는 크기다. 하지만 OOH(옥외) 미디어에서는 선반 가장자리의 라벨 크기부터 여러 축구 경기장 크기까지 다양한 크기의 광고를 거래하고 제공할 수 있다. 이는 시청자가 손에 들거나 거실 벽에 걸 수 있는 크기를 훨씬 뛰어넘는다.

OOH 디스플레이의 크기와 방향은 광고를 볼 수 있는 관객의 규모뿐만 아니라, 광고를 실제로 볼 가능성에도 영향을 미친다.

OOH와 디지털 디스플레이 광고의 공통점은 다양한 크기, 해상도, 종횡비를 수용해야 한다는 점이다. 물리적 디스플레이가 물리적 공간에 '구축되는' 방식이 다양하며, 추가 콘텐츠(예: 티커, 애플리케이션, 라벨)가 포함될 수 있어 광고 슬롯의 크기가 달라질 수 있다.


#### 7.9.2.2 사설 네트워크 및 위치 정보

대부분의 상업용 DOOH 디지털 디스플레이는 '왈드 가든(walled garden)' 형태의 사설 IP 네트워크에 위치한다. 이는 디스플레이를 다양한 인터넷 보안 문제, 취약점 및 공격으로부터 보호한다.

이러한 구조는 '왈드 가든' 보안을 통해 허용된 URL '안전 목록(safe-lists)'에 의해 제3자 광고 서비스, 쿠키 및 HTTP 이벤트 로깅 서비스가 제한될 수 있다는 것을 의미한다.

따라서 많은 미디어 소유자 및 퍼블리셔는 자체적인 '1st Party' 플레이아웃 리포트와 확인서를 발행하며, '1st Party' 광고 서버 및/또는 CMS 시스템을 사용한다.

사설 IP 네트워크의 사용은 DSP(디지털 광고 플랫폼)가 일반적인 IP 주소 기반 지리적 위치 정보 기술을 사용해 광고가 전달된 위치에 대한 정보를 얻을 수 없음을 의미한다. 하지만 퍼블리셔가 제공한 위치 정보(예: 위도/경도, 주소, 우편번호, 지역 등)는 거의 항상 사용 가능하다. 이동 중인 미디어(예: 택시 상단 디스플레이, 버스 패널 등)의 경우, 근실시간 GPS 기반 정보가 일반적으로 사용된다.


#### 7.9.2.3 비지속적 연결 / 실시간보다 긴 지연

도시와 외곽 지역에 설치된 대부분의 DOOH 디스플레이 패널은 네트워크 연결을 위해 셀룰러 네트워크에 의존한다. 미디어 소유자가 통신사와의 전용 네트워크를 보유하고 있더라도, 여전히 지역 셀 타워의 혼잡 상황에 영향을 받는다. 특정 시간대와 위치에서 셀 타워의 과도한 사용은 DOOH 디스플레이 패널이 비지속적인 인터넷 연결을 갖게 만든다.

이 문제를 해결하기 위해 일부 DOOH 미디어 소유자와 퍼블리셔는 '전송 및 저장' 기술을 사용하고, 입찰 요청부터 디스플레이까지 일정한 시간 여유를 둔다. 입찰 요청을 미리 받아 디바이스에 콘텐츠를 미리 버퍼링하거나 '플레이리스트'를 채우고, 플레이백 확인은 퍼블리셔 시스템 내에서 로그 수집이나 처리가 완료된 후에 이루어진다.

현재 업계에서 인정하는 '입찰 확인'부터 '디스플레이'까지의 시간은 최대 1~2시간이다.


#### 7.9.2.4 디바이스 고유 속성

TV, 태블릿, 모바일 폰 시장과 달리 디지털 옥외 광고(Digital OOH) 스크린 기술을 공급하는 전 세계적으로 지배적인 브랜드는 없다. 미디어 소유자나 퍼블리셔는 다양한 제조업체, 기술, 설치 파트너로부터 자신만의 스크린 기술을 조달한다. 이로 인해 각 네트워크마다 고유한 디바이스 타입, 식별자, 사용자 에이전트 문자열 등의 속성을 가지게 된다.

일부 국가에서는 디지털 광고 단위의 형태, 크기, 포맷을 설명하기 위한 표준을 만들려고 시도했지만, 현재까지 디지털 옥외 광고 디바이스나 이를 통해 도달할 수 있는 사용자를 식별하는 데 있어 인정받는 글로벌 표준은 없다.

사용자 에이전트의 경우, 미디어 소유자가 비표준 문자열을 사용하는 경우가 많다. 이는 디바이스 감지 및 트래픽 보호 시스템에 문제를 일으키는 것으로 알려져 있다. 미디어 소유자는 IETF가 정한 HTTP 사용자 에이전트 표준을 준수하고, 해당 페이지의 "Submit here" 버튼을 사용해 IAB Spiders and Bots List에 사용자 에이전트를 제출하는 것이 좋다.


#### 7.9.2.5 OpenRTB에서 DOOH 디바이스 참조를 위한 주요 객체 속성

DOOH(디지털 아웃 오브 홈) 미디어의 프로그래매틱 거래를 가능하게 하기 위해 OpenRTB 스펙에 `imp.qty` 및 `dooh`와 같은 주요 객체가 추가되었다. 다음 표는 DOOH 입찰 거래 시 자주 사용되는 OpenRTB 객체 참조에 대한 가이드를 제공한다.

| 객체 참조                 | 타입                | 구현 가이드                                                                                                                                                                                                                   |
| ----------------------- | ------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| device.geo              | 객체                | IP 주소를 사용할 수 없는 경우, DOOH 거래를 위해 위도(lat)와 경도(lon) 필드가 필수적이다. `geo.type`도 권장된다.                                                                                                                  |
| device.devicetype       | 문자열 배열         | 디지털 아웃 오브 홈 디바이스는 타입 8로 식별해야 한다.                                                                                                                                                                                |
| device.ppi              | 정수                | PPI, 너비(w), 높이(h)를 사용해 화면 크기를 인치 단위로 계산할 수 있다.                                                                                                                                                                         |
| device.ifa              | 문자열              | 개별 아웃 오브 홈 디바이스를 식별하기 위한 디바이스 ID. `device.ifa`는 사용자 식별이나 대상자 타겟팅 목적으로 사용하지 않아야 하며, 주로 빈도 제한과 같은 목적으로 활용할 수 있다.|
| device.ifa_type        | 문자열              | DOOH의 경우, 일반적으로 "ppid"(퍼블리셔 제공 디바이스 ID) 또는 "sspid"(거래소 제공 디바이스 ID)로 표시된다.                                                                                         |
| device.eids             | 객체                | 추가 식별자를 전송하기 위해 사용된다. 예를 들어, `geopath.org` 또는 `oohspace.co.uk`와 같은 정보나 `ifa` 제공자를 시그널링할 수 있다. AdCom의 `eids`를 참고한다.                                                                                     |
| imp.video.boxingallowed | 정수                | DOOH의 경우, `boxingallowed = 0`일 때 비디오의 가로세로 비율은 반드시 배치 위치의 비율과 일치해야 하며, 이는 비디오의 너비(w)와 높이(h) 필드로 결정된다.                                                                                          |
| imp.dt                  | 실수                | 아이템이 이행될 것으로 예상되는 시간(예: DOOH 광고가 표시될 시간)을 Unix 형식(에포크 이후 밀리초)으로 기록한 타임스탬프.                                                                                 |


### 7.9.3 상업적으로 중요한 광고 품질

한 사람에게 한 번 잘못된 광고가 노출되는 것은 버틸 수 있다. 하지만 공공장소에서 수천 명에게 동시에 잘못된 광고가 노출된다면, 미디어 소유자나 퍼블리셔는 스크린 네트워크에 광고를 제공할 수 있는 계약이나 권한을 잃을 위험에 처하게 된다.

대규모 상업 네트워크에 게재되는 모든 광고는 퍼블리셔(그리고 경우에 따라 장소 임대인 같은 제3자)의 사전 승인을 받아야 한다. 이 승인 과정은 일반적으로 사람이 직접 시각적으로 검토하는 방식으로 이루어진다. 이 과정을 거치지 않으면 광고를 게재할 수 없다.

이러한 이유로 광고 크리에이티브 승인에는 보통 '영업일' 단위의 시간이 소요된다. 물론 운영 프로세스를 통해 이를 단축할 수도 있다. 또한 많은 퍼블리셔와 네트워크는 승인 후 크리에이티브의 변경, 동적 콘텐츠, 또는 로테이션을 금지한다. 추가 검토가 필요하기 때문이다. 제3자 광고 서빙(3PAS)과 HTML 지원이 가능할 수 있지만, 동적 콘텐츠, 애니메이션, DCO 같은 일반 배너 광고의 변형에는 제한이 따를 수 있다.

이러한 이유로 DOOH(디지털 아웃오브홈) 광고 교환에 크리에이티브를 제출할 때는 IAB 광고 관리 API(https://github.com/InteractiveAdvertisingBureau/AdManagementAPI/blob/master/Ad%20Management%20API%201.0%20FINAL.md) 사용을 강력히 권장한다. 다만, 많은 SSP(공급자 측 플랫폼)는 특정 퍼블리셔에게 광고를 제출할 수 있도록 자체 확장 기능을 제공할 수도 있다.


### 7.9.4 DOOH 가격 책정

입찰가와 클리어링 가격은 CPM(천회 노출당 비용)으로 표현한다.  
예를 들어, 광고주가 1차 가격 경매에서 $2.50 CPM으로 입찰하고, 경매가 30.3회 노출을 대상으로 한다면:
multiplier = 30.3 (입찰 요청에서 전달된 노출 배수)
bid.price = 2.50 (입찰 응답에서 전달된 CPM 기준 입찰가)

광고주가 경매에서 승리하면, 트래킹 URL(예: burl) 매크로에는 다음과 같은 값이 포함된다:
${AUCTION_PRICE} = 2.50 (경매의 클리어링 가격)
${AUCTION_MULTIPLIER} = 30.3 (획득한 총 노출 수; 확인용. 이 값은 항상 입찰 요청에서 전달된 배수 값보다 작거나 같다. 또한 이 값은 0보다 큰 부동소수점이며, 1보다 작을 수도 있다.)

거래의 총 비용을 계산하는 공식은 다음과 같다:
(AUCTION_PRICE / 1000) * AUCTION_MULTIPLIER = COST
(2.50 / 1000) * 30.3 = $0.07575

위 경매 결과는 $0.07575의 청구서로 이어진다.


### 7.9.5 경매 알림

DOOH(디지털 아웃오브홈)에서는 경매에서 승리한 후 실제로 크리에이티브가 렌더링되기까지 상당한 지연이 발생할 수 있다. 이러한 이유로 OpenRTB 모범 사례에 따라 승리 이벤트와 청구 이벤트를 분리하는 것을 강력히 권장한다:
- **nurl**: 경매에서 입찰이 승리했을 때 발생하는 경매 이벤트 알림 URL. 이는 반드시 노출이 발생한다는 보장은 아니다.
- **burl**: 크리에이티브가 화면에 렌더링되고 노출이 청구 가능한 상태가 되었을 때 발생하는 경매 이벤트 청구 URL.


### 7.9.6 - DOOH 예제 시나리오

#### 7.9.6.1 - DOOH 배너 입찰 요청

```javascript
{
    "id": "162059897743978051070",
    "at": 1,
    "imp": [
        {
            "id": "007",
            "secure": 1,
            "exp": 360,
            "bidfloor": 5.0,
            "bidfloorcur": "GBP",
            "banner": {
                "w": 1080,
                "h": 1920,
                "format": [
                    {
                        "w": 1080,
                        "h": 1920
                    },
                    {
                        "w": 720,
                        "h": 1366
                    }
                ],
                "mimes": [
                    "image/jpg",
                    "image/png",
                    "text/html"
                ]
            },
            "pmp": {
                "private_auction": 0,
                "deals": [
                    {
                        "id": "123",
                        "at": 1,
                        "bidfloor": 4.50
                    },
                    {
                        "id": "333",
                        "at": 1,
                        "bidfloor": 3.00
                    },
                    {
                        "id": "444",
                        "at": 1,
                        "bidfloor": 2.00
                    }
                ]
            },
            "dt": 12345670,
            "qty": {
                "multiplier": 14.2,
                "sourcetype": 1,
                "vendor": "route.org.uk"
            }
        }
    ],
    "device": {
        "geo": {
            "lat": 0.0001,
            "long": -0.1235,
            "lastfix": 0
        },
        "devicetype": 8,
        "w": 1080,
        "h": 1920,
        "ppi": 72,
        "ifa": "1235461904",
        "ifa_type": "ppid",
        "eids": [
            {
                "source": "oohspace.co.uk",
                "uids": [
                    {
                        "atype": 501,
                        "id": "1235461904"
                    }
                ]
            }
        ]
    },
    "dooh": {
        "content": {},
        "id": "15790",
        "keywords": "Roadside, Billboard, D96",
        "name": "This",
        "publisher": {
            "id": "G1",
            "name": "Global"
        },
        "domain": "global.com",
        "venuetax": 1,
        "venuetypeid": 30101
    },
    "cur": [
        "GBP"
    ]
}
```


#### 7.9.6.2 - 배너 입찰 응답

```javascript
{
	"id": "1234567890",
	"bidid": "162059897743978051070",
	"cur": "GBP",
	"seatbid": [
		{
			"seat": "512",
			"bid": [
				{
					"id": "1",
					"impid": "102",
					"price": 9.43,
					"banner": {
						"img": "http://adserver.com/creative112.jpg"
					},
					"burl": "http://adserver.com/billingnotice?impid=102& bidid=abc1123&price=${AUCTION_PRICE}&multiplier=${AUCTION_MULTIPLIER}",
					"adomain": [
						"advertiserdomain.com"
					],
					"cid": "campaign111",
					"crid": "creative112",
					"attr": [
						1,
						2,
						3,
						4,
						5,
						6,
						7,
						12
					],
					"w": 1080,
					"h": 1920,
					"cat": [
						"IAB1"
					]
				}
			]
		}
	]
}
```


#### 7.9.6.3 - DOOH 비디오 입찰 요청

```javascript
{
    "id": "873465983764395",
    "at": 1,
    "imp": [
        {
            "id": "123456",
            "secure": 1,
            "exp": 720,
            "bidfloor": 4.8,
            "bidfloorcur": "GBP",
            "video": {
                "boxingallowed": 1,
                "w": 960,
                "h": 480,
                "maxduration": 20,
                "minduration": 20,
                "mimes": [
                    "video/jpeg",
                    "video/mp4",
                    "video/mov"
                ]
            },
            "pmp": {
                "private_auction": 1,
                "deals": [
                    {
                        "id": "V123",
                        "at": 1,
                        "bidfloor": 4.50
                    }
                ]
            },
            "dt": 1647010095,
            "qty": {
                "multiplier": 14.2,
                "sourcetype": 0,
                "vendor": "route.org.uk"
            }
        }
    ],
    "device": {
        "geo": {
            "lat": 51.51112,
            "long": -0.09043,
            "lastfix": 0
        },
        "devicetype": 8,
        "w": 960,
        "h": 480,
        "ppi": 3,
        "ifa": "1234928801",
        "ifa_type": "ppid",
        "eids": [
            {
                "source": "oohspace.co.uk",
                "uids": [
                    {
                        "atype": 501,
                        "id": "1234928801"
                    }
                ]
            }
        ]
    },
    "dooh": {
        "content": {},
        "id": "1Frame",
        "keywords": "LargeFormat,CANNON STREET STN,CANNON STREET,MAIN CONCOURSE",
        "name": "Transvision",
        "publisher": {
            "id": "VJCDUK",
            "name": "viooh"
        },
        "domain": "viooh.com",
        "venuetax": 1,
        "venuetypeid": 10602
    },
    "cur": [
        "GBP"
    ]
}
```


#### 7.9.6.4 - DOOH 비디오 입찰 응답

```javascript
{
	"id": "1234567890",
	"bidid": "162059897743978051070",
	"cur": "GBP",
	"seatbid": [
		{
			"seat": "512",
			"bid": [
				{
					"id": "1",
					"impid": "102",
					"price": 9.43,
					"nurl": "http://adserver.com/winnotice?impid=102&bidid=abc1123",
					"burl": "http://adserver.com/billingnotice?impid=102&bidid=abc1123&price=${AUCTION_PRICE}&multiplier=${AUCTION_MULTIPLIER}",
					"adm": "<?xml version="1.0" encoding="UTF-8"?><VAST version="4.0"><Ad id="79ba491b-dfe1-5044-9d8e-758ae874e24f"> <InLine><AdSystem>AdServer</AdSystem><AdTitle><![CDATA[DOOH Video ad]></AdTitle><Error><![CDATA[https://adserver.com/event/error]]></Error><Impression><![CDATA[https://adserver.com/event/impression]]></Impression><Creatives> <Creative id="79ba491b-dfe1-5044-9d8e-758ae874e24f"><Linear> <Duration>00:00:10</Duration> <MediaFiles><MediaFile delivery="progressive" bitrate="8326" width="1920" height="1080" type="video/mp4" scalable="true" maintainAspectRatio="true"> <![CDATA[https://adserver.com/creative.mp4]]> </MediaFile></MediaFiles></Linear></Creative></Creatives></InLine></Ad></VAST>",
					"adomain": [
						"advertiserdomain.com"
					],
					"cid": "campaign111",
					"crid": "creative112",
					"attr": [
						1,
						2,
						3,
						4,
						5,
						6,
						7,
						12
					],
					"w": 1920,
					"h": 1080,
					"cat": [
						"IAB1"
					]
				}
			]
		}
	]
}
```


## 7.10 - 업데이트된 비디오 시그널 <a name="videosignals"></a>

#### 7.10.1 - 예제

#### 7.10.1.1<strong> 인스트림 비디오:</strong>

소비자가 요청한 스트리밍 비디오 콘텐츠 전, 중간 또는 후에 재생되는 프리롤, 미드롤, 포스트롤 광고. 인스트림 비디오는 플레이어 시작 시 기본적으로 "소리 켜짐" 상태로 설정되거나, 사용자가 비디오 콘텐츠를 시청하려는 명확한 의도가 있어야 한다. 플레이어 주변에 다른 콘텐츠가 있을 수 있지만, 비디오 콘텐츠는 사용자의 방문 목적이어야 한다. 페이지의 주요 콘텐츠로 유지되고, 재생 중 오디오를 지원하는 유일한 비디오 플레이어여야 한다. 플레이어가 플로팅/스틱키 상태로 전환되면, 이후 광고 호출은 업데이트된 플레이어 크기를 정확히 전달해야 한다.
	
![](assets/Instream.gif)


#### 7.10.1.2 <strong>동반 콘텐츠:</strong>

스트리밍 비디오 콘텐츠 전, 중간, 후에 재생되는 프리롤, 미드롤, 포스트롤 광고를 말한다. 비디오 플레이어는 텍스트나 그래픽 콘텐츠의 문단 전, 중간, 후에 로드되고 재생되며, 뷰포트에 진입했을 때만 재생을 시작한다. 동반 콘텐츠는 뷰포트에 들어왔을 때만 재생을 시작해야 한다. 페이지를 스크롤하며 벗어날 때는 플로팅/스틱키 플레이어로 전환될 수 있다.

![](assets/Accompanying%20Content.gif)


#### 7.10.1.3<strong> 인터스티셜 광고: </strong>

비디오 콘텐츠 없이 재생되는 비디오 광고를 말한다. 재생 중에는 페이지의 주된 초점이 되어야 하며, 뷰포트의 대부분을 차지하고 스크롤로 화면 밖으로 이동할 수 없다. 앱 내 비디오나 슬라이드쇼와 같은 위치에 배치될 수 있다.

![](https://github.com/hillslatt/openrtb2.x/blob/develop/assets/interstitial.gif)


#### 7.10.1.4<strong> 독립형 콘텐츠 없음: </strong>

스트리밍 동영상 콘텐츠 없이 재생되는 동영상 광고. 슬라이드쇼, 네이티브 피드, 콘텐츠 내부 또는 스크롤 시 고정되는 형태로 배치될 수 있다.

![](assets/No%20Content_Standalone%20-%20Slideshow.gif)


#### 7.10.2 - Object: Video에서 plcmt 속성 사용하기

AdCOM의 업데이트된 정의와 새로운 속성(`plcmt` 속성)이 [Object: Video](2.6.md#objectvideo)에 추가되었다. 이를 통해 게시자는 기존 작업 흐름을 방해하지 않으면서도 업데이트된 광고 형식 가이드라인에 더 부합하는 방식으로 비디오 인벤토리를 신호할 수 있다.

<strong> 사례 1: In-stream에서 Instream으로 </strong>

게시자나 플레이어가 기존의 In-Stream 값과 업데이트된 Instream 정의를 모두 전송하려면, 기존 `placement` 속성에 `placement=1` 값을, 업데이트된 `plcmt` 속성에 `plcmt=1` 값을 비디오 객체에 포함시켜야 한다.

다음은 광고 요청 예시이다:

	"video": {
	“placement”: “1”,
	“plcmt”: “1” 
	}

`placement` 속성은 [AdCOM의 기존 List: Placement Subtypes - Video](https://github.com/InteractiveAdvertisingBureau/AdCOM/blob/master/AdCOM%20v1.0%20FINAL.md#list--placement-subtypes---video-)를 참조하며, 해당 정의에 따라 인벤토리를 In-stream으로 설명한다. 반면 `plcmt` 속성은 [업데이트된 List: Plcmt Subtypes - Video](https://github.com/InteractiveAdvertisingBureau/AdCOM/blob/master/AdCOM%20v1.0%20FINAL.md#list--plcmt-subtypes---video-)를 가리키며, 동일한 인벤토리를 업데이트된 정의에 따라 "Instream"으로 정의한다.

<strong> 사례 2: In-Article에서 No Content/Standalone으로 </strong>

게시자나 플레이어가 기존의 In-Article 값과 업데이트된 No Content/Standalone 정의를 모두 전송하려면, 기존 `placement` 속성에 `placement=3` 값을, 업데이트된 `plcmt` 속성에 `plcmt=4` 값을 비디오 객체에 포함시켜야 한다.

다음은 광고 요청 예시이다:

	"video": {
	“placement”: “3”,
	“plcmt”: “4” 
	}


## 7.11 - 플로어 사용 가이드 <a name="floors"></a>

### 7.11.1 - 플로어 필드의 역사

OpenRTB 2.6-202307 이전 버전에서는 `Imp`와 `Deal` 객체에 각각 `imp.bidfloor`와 `deal.bidfloor` 필드를 통해 플로어가 제공되었다. OpenRTB 2.6의 초기 릴리스(PDF 버전, GitHub 이전)에서는 `Audio`와 `Video` 객체에 `mincpmpersec` 필드가 도입되었으며, 이는 특정 포맷과 관련된 플로어 정보가 처음으로 연결된 사례다.

OpenRTB 2.6-202307부터는 `Deal` 객체에도 `mincpmpersec` 필드가 추가되었다. 이를 통해 오디오 또는 비디오 공급자는 광고 서버에서 광고의 지속 시간과 플로어 가격 간의 관계를 구매자에게 알릴 수 있다(오디오/비디오 광고 서빙에서 더 긴 지속 시간의 광고가 일반적으로 더 높은 가격으로 책정된다는 사실을 반영). 동시에, 비슷한 목적을 수행하는 새로운 객체인 Duration Floors(참조: [Object: DurFloors](2.6.md#objectdurfloors))가 `Audio`, `Video`, 그리고 `Deal` 객체에 추가되었다. Duration Floors의 목적은 크리에이티브의 지속 시간과 광고 기회의 플로어 가격 간의 비선형 관계를 표현할 수 있도록 하는 것이다.


### 7.11.2 - 판매자가 플로어 가이드라인을 제공하는 방법

판매자는 `BidRequest` 내 세 가지 위치에서 플로어를 지정할 수 있다:

- `Imp` (`imp.bidfloor`를 통해)
- `Video` 또는 `Audio` (`video.mincpmpersec` 또는 `video.durfloors`, 혹은 `audio.mincpmpersec` 또는 `audio.durfloors`를 통해)
- `Deal` (`deal.bidfloor` 또는 `deal.mincpmpersec` 또는 `deal.durfloors`를 통해)

`Video`와 `Audio` 객체에서 판매자는 반드시 한 가지 형태의 플로어 가이드라인만 포함해야 한다. 즉, 판매자는 `mincpmpersec` 또는 `durfloors` 중 하나만 제공해야 한다. 마찬가지로, `Deal` 객체에서도 판매자는 `mincpmpersec`, `durfloors`, `bidfloor` 중 하나만 제공해야 한다.


### 7.11.2 - 바이어가 플로어 가이드라인을 해석하는 방법

특정 **Deal ID**로 입찰하는 바이어는 해당 **Deal** 객체에 제공된 플로어 가이드라인을 사용해야 한다. **Deal** 객체에 플로어 가이드라인이 없거나 바이어가 오픈 마켓 광고 노출 기회에 입찰하는 경우, 바이어는 **Video** 또는 **Audio** 객체에 제공된 플로어 가이드라인을 참조하여 입찰을 진행해야 한다. 마지막으로, **Video** 또는 **Audio** 객체에 플로어 가이드라인이 제공되지 않거나 바이어가 네이티브 또는 배너 광고 노출 기회에 입찰하는 경우, **Imp** 객체에 제공된 플로어 가이드라인을 사용해야 한다.


## 7.12 - ID 매칭 방법 가이드라인 <a name="idmm"></a>

### 7.12.1 - ID 매칭 공개를 위한 모범 사례

구매자와 판매자 간 사전 협의가 이루어지지 않은 경우, <code>user.buyeruid</code> 필드의 값은 실시간 쿠키 동기화에서 파생된 것으로 간주한다([부록: 쿠키 동기화](https://github.com/openrtb2.x/blob/main/2.6.md#appendix-c-cookie-based-id-syncing-) 참조). 또한 <code>device.ifa</code> 필드의 값은 운영체제에 대한 광고 ID 호출에서 파생된 것으로 간주한다.

교환(Exchange)이 퍼블리셔에 의해 ID 대체가 발생했음을 제대로 공개하려면, SSP가 DSP의 ID를 어떻게 결정했는지와 관계없이 퍼블리셔가 보낸 <code>mm</code> 값을 DSP에 보내는 확장 식별자(eid)에 전파해야 한다.

어떤 당사자(예: SSP에서 DSP 쿠키 ID로)가 <code>mm</code> 값이 1 또는 2가 아닌 수신 EID를 기반으로 연결을 만들 경우, 수신자에게 보내는 ID는 수신 확장 식별자(EID)의 <code>mm</code> 값을 상속받아야 한다. 예를 들어, SSP가 어떤 종류의 매칭(<code>mm</code> 값 3, 4, 또는 5)을 기반으로 ID를 받은 경우, DSP에 보내는 ID가 쿠키 교환을 기반으로 하더라도 매칭이 발생했음을 표시해야 한다(즉, <code>mm</code> 값 3, 4, 또는 5).

아래 예제 4는 SSP가 쿠키 기반 동기화(<code>mm</code>=2)를 통해 DSP ID와 매칭할 수 있지만, 퍼블리셔로부터 브릿지된 ID(<code>mm</code>=3)를 받았기 때문에 DSP에 매칭 방법 3을 유지하는 워크플로를 보여준다.

EID 배열에서 <code>mm</code> 값이 1 또는 2인 항목은 일반적으로 선택적/정보 제공용이지만, 일부 구매자는 판매자가 이를 제공하는 것이 유용할 수 있다.


### 7.12.2 - 역할 개요

- <code>inserter</code>는 입찰 요청에 ID를 삽입하는 주체다. 주로 퍼블리셔나 SSP(Supply-Side Platform)가 이 역할을 맡는다. 즉, ID를 입찰 스트림에 포함시키기로 결정한 주체를 의미한다. 헤더 입찰(header bidding)의 경우, <code>inserter</code>는 퍼블리셔가 된다.<br></br>
- <code>source</code>는 ID를 정의하거나 생성한 주체다. 범용 ID(universal ID)나 대체 ID(alt-ID)의 경우, 해당 ID를 정의하거나 생성한 주체의 도메인을 나타낸다. 쿠키 ID의 경우, 쿠키가 속한 주체의 도메인을 의미한다. 파트너의 쿠키를 전송하기 전에, 해당 파트너가 선호하는 EID <code>source</code> 값을 확인하는 것이 좋다.<br>
- <code>matcher</code>는 ID 배열에 포함된 매치를 생성한 주체다. 이는 디바이스 그래프 벤더나 퍼블리셔 자신이 될 수 있다.


### 7.12.3 - 에이전트 타입과 매치 방법 신호 전달

<code>atype</code> 속성의 값은 입찰 스트림(bidstream)에서 ID의 수준을 설명하는 데 사용되며, 여러 매치 방법에 적용될 수 있다.

다음 표에서는 가능한 조합의 다양한 반복을 나열한다. <code>atype</code>과 매치 방법(<code>mm</code>) 신호를 함께 사용하는 방법에 대한 추가 JSON 예제는 다음 섹션에서 확인할 수 있다.

<table>
  <tr>
    <td><strong>atype 값</strong></td>
    <td><strong>atype 정의</strong></td>
    <td><strong>가능한 매치 방법</strong></td>
  </tr>
  <tr>
    <td>1</td>
    <td>특정 웹 브라우저나 디바이스에 연결된 ID (쿠키 기반, 확률적, 또는 기타 방법).</td>
    <td>하나의 브라우저 및/또는 디바이스와 관련된 모든 매치 방법. 어떤 <code>mm</code> 값이든 적용 가능하다.</td>  
  </tr>
  <tr>
    <td>2</td>
    <td>앱 내 노출(impressions), 일반적으로 디바이스 ID 타입을 포함 (또는 개인정보 보호를 준수한 버전의 디바이스 ID).</td>
    <td>단일 디바이스의 단일 애플리케이션과 관련된 매치 방법. 어떤 <code>mm</code> 값이든 적용 가능하지만, 대부분 3, 4, 또는 5일 가능성이 높다.</td>  
  </tr>
  <tr>
    <td>3</td>
    <td>개인 기반 ID, 즉 여러 디바이스에서 동일한 ID.</td>
    <td>여러 디바이스와 관련된 매치 방법. 어떤 <code>mm</code> 값이든 적용 가능하지만, 대부분 3 또는 5일 가능성이 높다.</td>  
  </tr>
</table>


### 7.12.4 - JSON 예제

#### 7.12.4.1 사용자 및 디바이스 ID

##### 예제 1. 실시간 쿠키 동기화에서 파생된 DSP 쿠키, 이후 관찰 가능

```
{
  "user": {
    "buyeruid": "FQAGL4yyYwOBNgDZ4PUqAQA8ewN"
  }
}
```


##### 예제 2. 운영체제에서 생성된 재설정 가능한 광고 ID

```
{
  "device": {
    "ifa": "df3a42f4-a388-43e9-a691-b0d308c963b4"
  }
}
```


#### 7.12.4.2 단일 속성에 대한 파생 ID

특정 상황에서 한 당사자가 파트너(일반적으로 DSP 또는 SSP)의 쿠키 사용자 ID나 IFA를 직접 관찰할 수는 없지만, 사용자에게 적용되거나 관련이 있다고 판단되는 대체 방법을 사용해 이를 추론할 수 있다. 이러한 상황은 아래 메커니즘을 통해 전달해야 한다.


##### 예제 3: Pub → SSP로의 요청, 해시된 이메일로 사용자 ID 매칭, SSP가 일반적인 방식으로 쿠키를 관찰할 수 없음

```
{
  "user": {
    "eids": [
      {
        "inserter": "pub.com",
        "matcher": "graphvendor.com",
        "source": "sspdomain.com",
        "mm": "3",
        "uids": [
          {
            "id": "ZK5GQGDZ-M-DK5U",
            "atype": "3"
          }
        ]
      }
    ]
  }
}
```
위 예제에서는 <code>buyeruid</code>가 없다는 점에 주목한다. SSP가 DSP로부터 <code>buyeruid</code> 필드에 매칭된 ID를 받고자 하는 명시적인 동의를 받지 않은 경우, SSP는 위 요청을 DSP로 그대로 전달한다. 이때 DSP가 graphvendor.com의 ID를 받고 싶지 않다면 <code>eids</code> 배열을 제거하고, graphvendor.com의 ID를 받고 싶다면 배열을 그대로 유지한다.


##### 예제 4: SSP → DSP로의 요청 (위의 pub 요청에 대응), SSP가 pub로부터 받은 브리지 ID를 사용하여 호스팅된 쿠키 매칭 테이블 조회를 통해 DSP의 buyeruid 설정

만약 매칭된 DSP ID를 <code>buyeruid</code>에 포함하기로 사전에 협의된 경우, 다음과 같이 처리한다:

<b>참고:</b> 이 방법은 SSP와 DSP 간에 사전에 <code>buyeruid</code>에 매칭된 ID를 포함하기로 직접 협의한 경우에만 사용해야 한다. 협의가 이루어지지 않은 경우, 해당 ID는 EIDS 배열로 전송해야 한다.

```
{
  "user": {
    "buyeruid": "FQAGL4yyYwOBNgDZ4PUqAQA8ewN",
    "eids": [
      {
        "inserter": "pub.com",
	"matcher": "graphvendor.com",
        "source": "sspdomain.com",
        "mm": "3",
        "uids": [
          {
            "id": "ZK5GQGDZ-M-DK5U",
            "atype": "3"
          }
        ]
      },
      {
        "inserter": "sspdomain.com",
        "source": "dspdomain.com",
        "mm": "3",
        "uids": [
          {
            "id": "FQAGL4yyYwOBNgDZ4PUqAQA8ewN",
            "atype": "1"
          }
        ]
      }
    ]
  }
}
```
이 예제에서 <code>mm</code> 값은 3으로 유지된다. 이는 매칭이 크로스 도메인 인증(예: 해시된 이메일)을 기반으로 한 ID 위에 구축되었기 때문이다.


#### 7.12.4.3 여러 속성 또는 기기 간 파생된 ID

##### 예제 5: SSP가 이메일 기반 해시와 ID를 매칭하여 DSP에 범용 ID 제공 (buyeruid 필드에 넣기로 사전에 합의된 경우)

```
{
  "user": {
    "buyeruid": "JE6!-1XvQEfD3cLpz7k1zAgY85k0PRJgkXdno7R2NXvKVhKsoSY8qpSb",
    "eids": [
      {
        "source": "sspdomain.com",
        "mm": "1",
        "uids": [
          {
            "id": "ZK5GQGDZ-M-DK5U",
            "atype": "1"
          }
        ]
      },
      {
        "inserter": "sspdomain.com",
	"matcher": "idvendor.com",
        "source": "universalid.com",
        "mm": "5",
        "uids": [
          {
            "id": "JE6!-1XvQEfD3cLpz7k1zAgY85k0PRJgkXdno7R2NXvKVhKsoSY8qpSb",
            "atype": "3"
          }
        ]
      }
    ]
  }
}
```


##### 예제 6: CTV 요청에서, 퍼블리셔는 앱 간 인증된 로그인을 기반으로 TV의 IFA와 동일한 가정 내 Apple 기기의 대체 ID를 함께 제공한다

```
{
  "device": {
    "ifa": "df3a42f4-a388-43e9-a691-b0d308c963b4"
  },
  "user": {
    "eids": [
      {
        "inserter": "app-pub.com",
        "matcher": "app-pub.com",
        "source": "apple.com",
        "mm": 3,
        "uids": [
          {
            "id": "fac13741-0648-436a-88cf-aceafdf45c9a",
            "atype": 2
          }
        ]
      },
      {       
        "inserter": "app-pub.com",
        "matcher": "app-pub.com",
        "source": "alt-id.org",
        "mm": 3,
        "uids": [
          {
            "id": "e7f8c5f2-6b4e-4565-8b0a-53d8b730143e",
            "atype": 3
          }
        ]
      }
    ]
  }
}
```


##### 예제 7: CTV 요청에서, 출판사는 TV의 IFA를 제공하면서 동일 가정 내 Apple 기기의 IFA도 확장 ID 배열에 추가한다. 이는 가정의 IP 주소와 디바이스 그래프를 기반으로 한다.

```
{
  "device": {
    "ifa": "df3a42f4-a388-43e9-a691-b0d308c963b4"
  },
  "user": {
    "eids": [
      {
        "inserter": "app-pub.com",
        "matcher": "graphvendor.com",
        "source": "apple.com",
        "mm": 5,
        "uids": [
          {
            "id": "fac13741-0648-436a-88cf-aceafdf45c9a",
            "atype": 2
          }
        ]
      }
    ]
  }
}
```


#### 7.12.4.4 세션 ID

##### 예제 8: FAST(무료 광고 지원 TV) 앱 개발자가 OS에서 제공된 디바이스 ID가 없는 요청에서 인증되지 않은 사용자에게 SSP에 ID를 제공하는 경우

```
{
  "user": {
    "eids": [
      {
        "inserter": "app-pub.com",
        "source": "app-pub.com",
        "mm": "4",
        "uids": [
          {
            "id": "ca0b9ab6-322a-4928-a849-798df75d2042"
          }
        ]
      }
    ]
  },
  "device": {}
}
```


## 7.13 - 장르와 gtax 속성 사용하기 <a name="genre"></a>

### 7.13.1 요약

현재 CTV 프로그램의 장르 정보는 OpenRTB에서 자유 텍스트 형식의 <code>genre</code> 속성을 통해 전송된다. 자유 텍스트 형식이기 때문에, 판매자들은 종종 내부 명명 규칙이나 긴 쉼표로 구분된 배열을 전달한다. 이로 인해 구매자와 DSP(Demand-Side Platform)가 프로그램적으로 장르 정보를 활용하여 타겟팅, 보고, 예측 등의 작업을 수행하기가 어렵다. IAB Tech Lab의 Content Taxonomy 3.1은 이를 해결하기 위해 설계되었다. 그러나 전체 분류 체계가 CTV 콘텐츠 장르 타겟팅에 필요한 범위보다 훨씬 크고 복잡하기 때문에, 우리는 [CTV Genre](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Taxonomy%20Mappings/CTV%20Genre%20Mapping.tsv)라는 전체 분류 체계의 하위 집합을 만들어 CTV/OTT 장르에 대한 분류 체계 사용을 간소화했다. 이 장르 목록은 판매자가 CTV 콘텐츠의 유형을 선언하고, 문맥 기반 구매자가 장르 시그널을 이해하고 타겟팅하는 데 활용하기 위한 것이다.

새로운 장르 목록은 Content Taxonomy 3.1의 하위 집합으로, [Object: Content](#objectcontent)의 <code>genres</code>와 <code>gtax</code> 속성과 함께 사용된다. 이러한 새로운 속성은 CTV 장르 타겟팅 구현을 간소화하고, 분류 체계의 작은 지정된 섹션을 사용하여 장르를 명확히 선언함으로써 통합 오류를 방지하기 위해 설계되었다.

퍼블리셔와 SSP(Supply-Side Platform)에게는 이 문서가 문맥 기반 구매자의 수요를 증가시키기 위해 콘텐츠 장르 시그널을 전송하는 방법에 대한 지침을 제공한다. DSP와 구매자에게는 이 문서가 판매자가 입찰 스트림에서 선언한 콘텐츠 장르 시그널에 대해 어떻게 대응할지에 대한 지침을 제공한다.

새로운 CTV 콘텐츠 장르 목록을 확인하려면 [CTV Genre Mapping](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Taxonomy%20Mappings/CTV%20Genre%20Mapping.tsv)을 참고한다.


### 7.13.2 사전 요구 사항

퍼블리셔와 SSP(Supply-Side Platform)는 [Object: Content](2.6.md#objectcontent)에서 <code>genres</code>와 <code>gtax</code>를 보내고 읽을 수 있어야 한다. 일반적으로 DSP(Demand-Side Platform)인 수신 측은 입찰 요청에서 전송된 [콘텐츠 분류 체계 3.1](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Content%20Taxonomies/Content%20Taxonomy%203.1.tsv) 또는 [지정된 CTV 장르 하위 집합](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Taxonomy%20Mappings/CTV%20Genre%20Mapping.tsv)을 읽을 수 있어야 한다. 퍼블리셔나 SSP는 [Object: Content](2.6.md#objectcontent)의 <code>gtax</code> 속성에서 전송한 열거형이 요청 수신자에게 이해될 수 있도록 해야 한다.

<code>genres</code>와 <code>gtax</code> 속성은 장편 콘텐츠에 초점을 맞추며, 입찰 요청에서 설명하는 콘텐츠의 장르만을 나타내도록 설계되었다. 퍼블리셔와 SSP는 사이트나 앱에 대한 다른 카테고리 정보를 [Object: Site](2.6.md#objectsite) 또는 [Object: App](2.6.md#objectapp)의 <code>cat</code>과 <code>cattax</code> 속성을 사용해 계속 전송해야 한다. [Object: Content](2.6.md#objectcontent)에서 <code>cat</code>과 <code>cattax</code> 속성을 사용하면 장르가 아닌 콘텐츠 자체에 대한 정보를 제공할 수 있다.


### 7.13.3 판매자 측 가이드라인

#### 퍼블리셔

[Object: Content](2.6.md#objectcontent)에 있는 <code>genres</code> 속성은 기존 <code>genre</code> 필드를 대체하기 위한 것이다. 이 속성은 <code>gtax</code> 속성이 가리키는 분류 체계(Taxonomy)에 포함된 열거형 값을 사용한다. 퍼블리셔는 프로그램의 장르 정보를 광고 기술 파트너에게 전달하기 위해 <code>genres</code>와 <code>gtax</code> 속성을 사용해야 한다. <code>genres</code> 속성은 전체 콘텐츠의 장르를 설명하는 데만 사용해야 한다. 콘텐츠의 세부 사항을 설명하려면 <code>cat</code>과 <code>cattax</code> 속성을 사용해야 하며, 이러한 속성을 장르를 설명하는 데 사용해서는 안 된다. 추가적인 자유 텍스트 메타데이터를 전달하려면 [Object: Content](2.6.md#objectcontent)의 <code>keywords</code> 또는 <code>kwarray</code> 속성을 사용해야 한다.

<code>gtax</code> 속성은 구매자와 판매자가 모두 이해할 수 있는 분류 체계를 정렬하는 데 사용된다. <code>gtax</code> 속성의 기본값은 [IAB Tech Lab Content Taxonomy 3.1](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Content%20Taxonomies/Content%20Taxonomy%203.1.tsv)이다. [Content Taxonomy 3.1](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Content%20Taxonomies/Content%20Taxonomy%203.1.tsv) 전체를 사용할 수 있지만, 최소한 [CTV 장르에 초점을 맞춘 하위 집합](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Taxonomy%20Mappings/CTV%20Genre%20Mapping.tsv)은 이해해야 한다.

콘텐츠를 분류하는 벤더를 사용하는 콘텐츠 소유자는 <code>gtax</code> 속성에 500 이상의 값을 사용해 해당 벤더를 지정해야 한다. 또한, 수신 측이 이러한 열거형 값을 읽고 이해할 수 있는지 확인해야 한다(자세한 내용은 사전 요구 사항 섹션 참조). 벤더의 열거형 값이 존재하는지, DSP 파트너가 이를 읽을 수 있는지 확인해야 한다. DSP 지원을 극대화하려면 [CTV 장르에 초점을 맞춘 하위 집합](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Taxonomy%20Mappings/CTV%20Genre%20Mapping.tsv)을 사용하는 것이 좋다.

퍼블리셔는 콘텐츠의 장르를 가장 잘 설명하는 최소한의 장르를 전달하는 것이 좋다. 가장 적합한 열거형 값을 <code>genres</code> 배열의 첫 번째 정수로 지정해야 한다.

구매자는 일반적으로 스케일을 달성하기 위해 장르의 허용 목록(allowlist)과 차단 목록(blocklist)을 사용한다. 단순히 최대한 많은 장르를 선언한다고 해서 추가 수요가 발생하는 것은 아니다. 오히려 너무 많은 장르를 전달하면 구매자가 콘텐츠 유형을 효과적으로 이해하고 적합성을 판단하기 어려워진다. 또한, 광고가 비디오 콘텐츠와 잘 어울릴 때 얻는 사용자 경험의 이점도 제한된다.

장르를 딜 타겟팅에 사용할 경우, 판매자는 단일 장르를 타겟팅하는 것보다 허용 목록과 차단 목록 타겟팅이 스케일을 달성하는 가장 일반적인 방법임을 명심해야 한다.

허용 목록 타겟팅은 함께 패키징하기에 적합한 유사한 콘텐츠 유형의 모든 장르를 대상으로 할 수 있다. 예를 들어, "엔터테인먼트" 패키지는 여러 장르를 그룹화할 수 있다. 반면, 차단 목록 타겟팅은 딜의 특정 타겟팅에 적합하지 않은 장르를 제외하는 데 사용할 수 있다.


#### SSPs

SSP는 현재 사용 중인 콘텐츠 <code>genre</code> 속성을 업그레이드하고, 대신 <code>genres</code>와 <code>gtax</code>를 DSP로 전달하는 방식으로 전환해야 한다.

구현자는 최소한 [Tech Lab Taxonomies GitHub 저장소](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Taxonomy%20Mappings/CTV%20Genre%20Mapping.tsv)에 나열된 Content Taxonomy 3.1의 ID 부분 집합을 읽어야 한다. <code>genres</code> 속성은 다른 IAB Tech Lab Taxonomy와 호환되지 않는다.

콘텐츠 분류를 위해 벤더를 사용하는 경우, SSP는 해당 벤더를 지정하기 위해 <code>gtax</code> 속성에 500+ 지정을 전달할 수 있어야 한다. 최선의 방법으로, SSP는 500+ 열거를 수신하는 DSP가 사용 중인 벤더 Taxonomy의 행을 읽고 이해할 수 있는지 확인해야 한다. DSP 지원을 극대화하기 위해 구현자는 관련 Taxonomy 및 Mapping GitHub 저장소에 나열된 [Content Taxonomy 3.1의 ID 부분 집합](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Taxonomy%20Mappings/CTV%20Genre%20Mapping.tsv)을 사용하는 것이 좋다.

이러한 속성을 활용해 프로그램의 장르를 표준화하고 열거함으로써, SSP는 CTV 인벤토리 파트너 간 표준화된 장르 목록을 기반으로 보고서 작성 및 딜 타겟팅을 구축할 수 있다.


### 7.13.4 구매자와 DSP를 위한 가이드라인

장르 하위 집합은 구매자가 프로그램 타겟팅, 보고 및 DSP가 제공하는 다른 용도로 활용할 수 있도록 고안되었다.

IAB Tech Lab의 콘텐츠 분류 체계를 사용하려는 구매자와 DSP는 최소한 [Tech Lab Taxonomies GitHub 저장소](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Taxonomy%20Mappings/CTV%20Genre%20Mapping.tsv)에 나열된 콘텐츠 분류 체계 3.1의 ID 하위 집합을 읽을 수 있어야 한다. 콘텐츠 분류를 위해 벤더를 사용하는 경우, DSP는 <code>gtax</code> 속성의 500+ 지정을 이해하고, <code>genres</code> 속성으로 전달된 실제 값들을 나열하는 관련 행을 읽을 수 있어야 한다.

장르를 설명하기 위해 <code>cat</code>, <code>cattax</code>, <code>keywords</code> 속성을 사용하기보다는, 이 속성들을 콘텐츠의 세부 사항을 설명하는 데 사용해야 한다. 콘텐츠 타겟팅은 오디언스 타겟팅 및 OpenRTB 2.x의 광고 크리에이티브의 콘텐츠/카테고리와 관련된 다른 속성과는 별개임을 유의해야 한다.

일반적으로, 장르에 대한 구매 측 타겟팅은 허용 목록과 차단 목록 타겟팅으로 구현되어 규모를 달성한다. 예를 들어, "엔터테인먼트" 캠페인은 여러 장르를 묶어 포함할 수 있다. 반면, 차단 목록 타겟팅은 브랜드에 적합하지 않거나 크리에이티브의 콘텐츠와 잘 맞지 않는 장르를 제외하는 데 사용할 수 있다.


### 7.13.5 장르 리스트에 대한 일반적인 가이드

CTV/OTT 콘텐츠에 가장 적합한 장르를 `content.genres` 속성에 명시한다. 이 속성은 정수 배열이며, [Content Taxonomy 3.1](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Content%20Taxonomies/Content%20Taxonomy%203.1.tsv)에서 허용된 장르 목록을 포함한다.

SSP(Supply-Side Platform)와 DSP(Demand-Side Platform)가 `content.genres`에 전달된 정보를 이해하고 읽을 수 있도록, 사용된 특정 분류 체계 버전을 `content.gtax` 속성에 명시한다.

기본적으로 [Content Taxonomy 3.1](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Content%20Taxonomies/Content%20Taxonomy%203.1.tsv)의 [하위 집합](https://github.com/InteractiveAdvertisingBureau/Taxonomies/blob/develop/Taxonomy%20Mappings/CTV%20Genre%20Mapping.tsv)을 사용해야 한다. 이 분류 체계는 [IAB Tech Lab Taxonomy and Mapping](https://github.com/InteractiveAdvertisingBureau/Taxonomies/tree/develop) GitHub 저장소에 열거되어 있다. 벤더나 커스텀 분류 체계를 사용하는 경우, SSP/DSP와 협력하여 해당 분류 체계가 전송 전에 읽을 수 있는지 확인해야 한다.


## 7.14 - cids 사용하기 <a name="cids"></a>

### 7.14.1 확장 콘텐츠 식별자(Extended Content Identifier)의 활용

비디오/오디오 콘텐츠의 메타데이터나 컨텍스트 기반 분류를 통해 타겟팅하려는 시장 수요가 존재한다. 이를 위해서는 개별 콘텐츠를 식별할 수 있는 체계가 필요하며, 이 정보를 입찰 요청에 전달하고 해당 콘텐츠의 메타데이터를 조회하거나 분류할 수 있어야 한다.

여러 회사나 서비스가 퍼블리셔로부터 메타데이터를 수집하고 통합하는 역할을 한다(이를 "콘텐츠 데이터 플랫폼"이라고 함). 이러한 서비스는 퍼블리셔로부터 비디오 콘텐츠 메타데이터를 수집하고, 각 콘텐츠에 대해 고유한 ID(여기서는 "확장 콘텐츠 식별자" 또는 "확장 콘텐츠 ID"라고 함)를 할당한다. 컨텍스트 데이터 공급업체는 이 통합된 메타데이터에 접근할 수 있으며, 확장 콘텐츠 ID가 제공되면 해당 메타데이터를 기반으로 콘텐츠를 분류할 수 있다.

다음 다이어그램은 이 과정을 보여준다. 숫자는 DSP의 관점에서 필수적인 흐름/순서를 나타낸다. 퍼블리셔와 콘텐츠 데이터 플랫폼 간의 데이터 흐름은 RTB 프로세스와는 별개로 진행된다.

![](https://github.com/InteractiveAdvertisingBureau/openrtb2.x/blob/main/assets/ECID.jpg)

RTB 프로세스에서의 순서는 다음과 같다:

1. 퍼블리셔는 광고 채우기를 위해 교환(exchange)에 보내는 요청에 확장 콘텐츠 ID(및 해당 ID의 출처)를 포함한다. 이는 콘텐츠 데이터 플랫폼에서 이전에 할당한 콘텐츠 ID여야 한다.
2. 교환은 이를 DSP에 보내는 입찰 요청에 포함한다.
3. DSP는 이를 컨텍스트 공급업체에 쿼리한다.
4. 컨텍스트 공급업체는 콘텐츠 데이터 플랫폼에 메타데이터를 요청한다.
5. 콘텐츠 데이터 플랫폼은 메타데이터를 반환한다.
6. 컨텍스트 공급업체는 DSP에 분류 결과를 반환한다. 이 분류는 컨텍스트 공급업체와 DSP 간에 합의된 기준에 따라 이루어지며, 메타데이터의 정보를 변환하거나 분류하는 방식으로 진행된다. 예를 들어, 공급업체는 시놉시스에 대한 주제 분류를 수행하거나, 콘텐츠 URL에 대한 비디오/오디오 인식을 수행할 수 있다.

실제로는 RTB의 실시간 제약으로 인해 3~6단계에서 하나 이상의 캐싱 계층이 관여할 수 있다.


### 7.14.2 확장된 콘텐츠 식별자 생성

<code>cids</code> 속성은 알파벳과 숫자로 이루어진 식별자를 지원하기 위한 문자열 배열이다. 그러나 <code>cids</code> 속성은 오직 콘텐츠 ID를 전달하는 용도로만 사용해야 한다. 외부 시스템의 콘텐츠 ID 이외의 값을 전달하는 것은 권장하지 않는다.


### 7.14.3 확장 콘텐츠 ID와 장르, 카테고리, 판매자 정의 컨텍스트 구분하기

확장 콘텐츠 ID(Extended Content IDs)는 단일 비디오/오디오 콘텐츠에 대한 고유 ID를 표현하기 위해 사용한다. 이 ID는 특정 분류 체계에 따라 콘텐츠를 카테고리화(예: "코미디", "개인 금융" 등)하는 데 사용하지 않는다. 이러한 목적을 위해서는 [Object: Content](https://github.com/InteractiveAdvertisingBureau/openrtb2.x/blob/main/2.6.md#3216---object-content-)의 <code>genres</code> 및/또는 <code>cat</code> 속성을 사용한다. 콘텐츠 카테고리화에 대한 추가 정보는 [7.13 - Using Genres and gtax Attributes](https://github.com/InteractiveAdvertisingBureau/openrtb2.x/blob/main/implementation.md#713---using-genres-and-gtax-attributes-)를 참조한다.

확장 콘텐츠 ID는 판매자가 정의한 컨텍스트를 표현하는 데에도 사용하지 않는다. 이를 위해서는 [Segment Taxonomies 커뮤니티 확장](https://github.com/InteractiveAdvertisingBureau/openrtb/blob/main/extensions/community_extensions/segtax.md)과 IAB Tech Lab의 [판매자 정의 대상 및 컨텍스트 신호 표준](https://iabtechlab.com/wp-content/uploads/2021/03/IABTechLab_Taxonomy_and_Data_Transparency_Standards_to_Support_Seller-defined_Audience_and_Context_Signaling_2021-03.pdf)을 참조한다.


### 7.14.4 콘텐츠 ID에 대한 추가 설명

<code>content.id</code> 속성은 판매자 시스템 내에서 콘텐츠의 ID를 표현하는 데만 사용해야 한다. 외부 콘텐츠 분류 서비스에서 제공하는 ID는 <code>content.data.cids</code> 배열에 열거하고 네임스페이스를 지정해야 한다.

확장 콘텐츠 ID를 제공하는 프로바이더나 소스는 자신이 소유한 루트 도메인을 결정하고 이를 일관되게 사용해 자신을 식별해야 한다. 일반적으로 이 도메인은 프로바이더의 비즈니스나 운영 도메인이어야 한다. 만약 퍼블리셔가 메타데이터 집계자로부터 제공받지 않은 자체 확장 콘텐츠 ID를 전달한다면, 마찬가지로 자신이 소유한 루트 도메인을 선택하고 이를 일관되게 사용해 자신을 식별해야 한다.

SSP와 DSP는 확장 콘텐츠 ID를 활용할 수 있지만, 이들을 불투명한 문자열로 처리하고 사용하거나 이해하려고 하지 않는 것도 완전히 허용된다. 최소한 SSP는 이 필드를 통과시켜야 하며, DSP는 컨텍스트 데이터 프로바이더와 협력해 타겟팅을 위한 세그먼트를 활성화하는 데 사용할 수 있도록 허용해야 한다. 그러나 판매자는 요청을 받는 측이 읽고, 이해하고, 해석할 수 있는 프로바이더의 확장 콘텐츠 ID만 전송해야 한다.


### 7.14.5 JSON 예제

#### 예제 1 - 단일 확장 콘텐츠 식별자 벤더 :

```
{
  "app": {
    "content": {
      "id": "video_123",
      "data": [
        {
          "name": "vendorA.com",
          "cids": [
            "vendorA_c73g5jq96mwso4d8"
          ],
          "segment": [
            {
              "id": "context_5784065"
            },
            {
              "id": "context_5711828"
            }
          ]
        }
      ]
    }
  }
}
...
```


#### 예제 2 - 다중 확장 콘텐츠 식별자 공급업체:

```
{
  "app": {
    "content": {
      "id": "video_123",
      "data": [
        {
          "name": "vendorA.com",
          "cids": [
            "vendorA_c73g5jq96mwso4d8"
          ],
          "segment": [
            {
              "id": "context_5784065"
            },
            {
              "id": "context_5711828"
            }
          ]
        },
        {
          "name": "vendorB.com",
          "cids": [
            "MV020788170000"
          ]
        }
      ]
    }
  }
}
```


